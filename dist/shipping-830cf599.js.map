{"version":3,"file":"shipping-830cf599.js","mappings":"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","sources":["webpack://checkout/./packages/core/src/app/common/dom/getAppliedStyles.ts","webpack://checkout/./packages/core/src/app/common/form/connectFormik.tsx","webpack://checkout/./packages/core/src/app/common/utility/parseAnchor.ts","webpack://checkout/./packages/core/src/app/locale/TranslatedLink.tsx","webpack://checkout/./packages/core/src/app/shipping/errors/UnassignItemError.ts","webpack://checkout/./packages/core/src/app/shipping/getShippingMethodId.ts","webpack://checkout/./packages/core/src/app/address/AddressFormModal.tsx","webpack://checkout/./packages/core/src/app/shipping/errors/AssignItemInvalidAddressError.ts","webpack://checkout/./packages/core/src/app/shipping/errors/AssignItemFailedError.ts","webpack://checkout/./packages/core/src/app/shipping/findConsignment.ts","webpack://checkout/./packages/core/src/app/shipping/getShippableLineItems.ts","webpack://checkout/./packages/core/src/app/shipping/ItemAddressSelect.tsx","webpack://checkout/./packages/core/src/app/shipping/getRecommendedShippingOption.ts","webpack://checkout/./packages/core/src/app/shipping/shippingOption/ShippingOptionsList.tsx","webpack://checkout/./packages/core/src/app/shipping/shippingOption/ShippingOptionsForm.tsx","webpack://checkout/./packages/core/src/app/shipping/shippingOption/ShippingOptions.tsx","webpack://checkout/./packages/core/src/app/shipping/ShippingFormFooter.tsx","webpack://checkout/./packages/core/src/app/shipping/updateShippableItems.ts","webpack://checkout/./packages/core/src/app/shipping/MultiShippingForm.tsx","webpack://checkout/./packages/core/src/app/shipping/BillingSameAsShippingField.tsx","webpack://checkout/./packages/core/src/app/shipping/RemoteShippingAddress.tsx","webpack://checkout/./packages/core/src/app/shipping/ShippingAddressForm.tsx","webpack://checkout/./packages/core/src/app/shipping/StaticAddressEditable.tsx","webpack://checkout/./packages/core/src/app/shipping/ShippingAddress.tsx","webpack://checkout/./packages/core/src/app/shipping/ShippingAddressFields.ts","webpack://checkout/./packages/core/src/app/shipping/SingleShippingForm.tsx","webpack://checkout/./packages/core/src/app/shipping/ShippingForm.tsx","webpack://checkout/./packages/core/src/app/shipping/ShippingHeader.tsx","webpack://checkout/./packages/core/src/app/shipping/stripeUPE/StripeShippingAddressDisplay.tsx","webpack://checkout/./packages/core/src/app/shipping/stripeUPE/StripeStateMapper.ts","webpack://checkout/./packages/core/src/app/shipping/stripeUPE/StripeShippingAddress.tsx","webpack://checkout/./packages/core/src/app/shipping/stripeUPE/StripeShippingForm.tsx","webpack://checkout/./packages/core/src/app/shipping/stripeUPE/StripeShipping.tsx","webpack://checkout/./packages/core/src/app/shipping/Shipping.tsx","webpack://checkout/./packages/core/src/app/ui/accordion/AccordionContext.tsx","webpack://checkout/./packages/core/src/app/ui/accordion/Accordion.tsx","webpack://checkout/./packages/core/src/app/ui/form/Checklist.tsx","webpack://checkout/./packages/core/src/app/ui/accordion/AccordionItem.tsx","webpack://checkout/./packages/core/src/app/ui/form/ChecklistItemInput.tsx","webpack://checkout/./packages/core/src/app/ui/form/ChecklistItem.tsx"],"sourcesContent":["import { kebabCase } from 'lodash';\r\n\r\nexport default function getAppliedStyles(\r\n    element: HTMLElement,\r\n    properties: string[],\r\n): { [key: string]: string } {\r\n    const declaration = window.getComputedStyle(element);\r\n\r\n    return properties.reduce(\r\n        (result, propertyName) => ({\r\n            ...result,\r\n            [propertyName]: declaration.getPropertyValue(kebabCase(propertyName)),\r\n        }),\r\n        {},\r\n    );\r\n}\r\n","import { connect } from 'formik';\r\nimport React, { ComponentType, FunctionComponent, memo } from 'react';\r\nimport shallowEqual from 'shallowequal';\r\n\r\nimport ConnectFormikProps from './ConnectFormikProps';\r\n\r\nexport default function connectFormik<TProps extends ConnectFormikProps<TValues>, TValues = any>(\r\n    OriginalComponent: ComponentType<TProps>,\r\n): ComponentType<Omit<TProps, keyof ConnectFormikProps<TValues>>> {\r\n    const InnerComponent: FunctionComponent<TProps> = memo(\r\n        (props) => <OriginalComponent {...props} />,\r\n        ({ formik: prevFormik, ...prevProps }, { formik: nextFormik, ...nextProps }) =>\r\n            shallowEqual(prevFormik, nextFormik) && shallowEqual(prevProps, nextProps),\r\n    );\r\n\r\n    const DecoratedComponent = connect<TProps, TValues>(InnerComponent) as ComponentType<\r\n        Omit<TProps, keyof ConnectFormikProps<TValues>>\r\n    >;\r\n\r\n    DecoratedComponent.displayName = `ConnectFormik(${\r\n        OriginalComponent.displayName || OriginalComponent.name\r\n    })`;\r\n\r\n    return DecoratedComponent;\r\n}\r\n","export default function parseAnchor(text: string): string[] {\r\n    const div = document.createElement('div');\r\n\r\n    div.innerHTML = text;\r\n\r\n    const anchor = div.querySelector('a');\r\n\r\n    if (!anchor) {\r\n        return [];\r\n    }\r\n\r\n    const anchorSiblings = div.innerHTML.split(anchor.outerHTML);\r\n\r\n    return [anchorSiblings[0], anchor.text, anchorSiblings[1]];\r\n}\r\n","import React, { FunctionComponent, MouseEventHandler } from 'react';\r\n\r\nimport { preventDefault } from '../common/dom';\r\nimport { parseAnchor } from '../common/utility';\r\n\r\nimport { TranslatedStringProps } from './TranslatedString';\r\nimport withLanguage, { WithLanguageProps } from './withLanguage';\r\n\r\nexport type TranslatedLinkProps = TranslatedStringProps & {\r\n    testId?: string;\r\n    onClick: MouseEventHandler;\r\n};\r\n\r\nconst TranslatedLink: FunctionComponent<TranslatedLinkProps & WithLanguageProps> = ({\r\n    data,\r\n    id,\r\n    language,\r\n    onClick,\r\n    testId,\r\n}) => {\r\n    const translatedString = language.translate(id, data);\r\n    const parsedString = parseAnchor(translatedString);\r\n\r\n    return parsedString.length ? (\r\n        <>\r\n            {parsedString[0]}\r\n            <a data-test={testId} href=\"#\" onClick={preventDefault(onClick)}>\r\n                {parsedString[1]}\r\n            </a>\r\n            {parsedString[2]}\r\n        </>\r\n    ) : (\r\n        <>{translatedString}</>\r\n    );\r\n};\r\n\r\nexport default withLanguage(TranslatedLink);\r\n","import { CustomError, setPrototypeOf } from '../../common/error';\r\nimport { getLanguageService } from '../../locale';\r\n\r\nexport default class UnassignItemError extends CustomError {\r\n    constructor(data: Error) {\r\n        super({\r\n            name: 'UNASSIGN_ITEM_FAILED',\r\n            message: getLanguageService().translate('shipping.unassign_item_error'),\r\n            data,\r\n        });\r\n\r\n        setPrototypeOf(this, UnassignItemError.prototype);\r\n    }\r\n}\r\n","import { Checkout } from '@bigcommerce/checkout-sdk';\r\n\r\nimport { getPreselectedPayment } from '../payment';\r\n\r\nexport default function getShippingMethodId(checkout: Checkout): string | undefined {\r\n    const SHIPPING_METHOD_IDS = ['amazon', 'amazonpay'];\r\n    const preselectedPayment = getPreselectedPayment(checkout);\r\n\r\n    return preselectedPayment && SHIPPING_METHOD_IDS.indexOf(preselectedPayment.providerId) > -1\r\n        ? preselectedPayment.providerId\r\n        : undefined;\r\n}\r\n","import { Country, FormField } from '@bigcommerce/checkout-sdk';\r\nimport { FormikProps, withFormik } from 'formik';\r\nimport React, { FunctionComponent } from 'react';\r\nimport { lazy } from 'yup';\r\n\r\nimport { preventDefault } from '../common/dom';\r\nimport { TranslatedString, withLanguage, WithLanguageProps } from '../locale';\r\nimport { Button, ButtonVariant } from '../ui/button';\r\nimport { Form } from '../ui/form';\r\nimport { LoadingOverlay } from '../ui/loading';\r\nimport { Modal, ModalHeader } from '../ui/modal';\r\n\r\nimport AddressForm from './AddressForm';\r\nimport getAddressFormFieldsValidationSchema from './getAddressFormFieldsValidationSchema';\r\nimport { AddressFormValues } from './mapAddressToFormValues';\r\n\r\nexport interface AddressFormModalProps extends AddressFormProps {\r\n    isOpen: boolean;\r\n    onAfterOpen?(): void;\r\n}\r\n\r\nexport interface AddressFormProps {\r\n    countries?: Country[];\r\n    countriesWithAutocomplete: string[];\r\n    googleMapsApiKey?: string;\r\n    isLoading: boolean;\r\n    shouldShowSaveAddress?: boolean;\r\n    defaultCountryCode?: string;\r\n    useFloatingLabel?: boolean;\r\n    getFields(countryCode?: string): FormField[];\r\n    onSaveAddress(address: AddressFormValues): void;\r\n    onRequestClose?(): void;\r\n}\r\n\r\nconst SaveAddress: FunctionComponent<\r\n    AddressFormProps & WithLanguageProps & FormikProps<AddressFormValues>\r\n> = ({\r\n    googleMapsApiKey,\r\n    getFields,\r\n    countriesWithAutocomplete,\r\n    countries,\r\n    values,\r\n    setFieldValue,\r\n    isLoading,\r\n    onRequestClose,\r\n    useFloatingLabel,\r\n}) => (\r\n    <Form autoComplete=\"on\">\r\n        <LoadingOverlay isLoading={isLoading}>\r\n            <AddressForm\r\n                countries={countries}\r\n                countriesWithAutocomplete={countriesWithAutocomplete}\r\n                countryCode={values.countryCode}\r\n                formFields={getFields(values.countryCode)}\r\n                googleMapsApiKey={googleMapsApiKey}\r\n                setFieldValue={setFieldValue}\r\n                shouldShowSaveAddress={false}\r\n                useFloatingLabel={useFloatingLabel}\r\n            />\r\n            <div className=\"form-actions\">\r\n                <a\r\n                    className=\"button optimizedCheckout-buttonSecondary\"\r\n                    href=\"#\"\r\n                    onClick={preventDefault(onRequestClose)}\r\n                >\r\n                    <TranslatedString id=\"common.cancel_action\" />\r\n                </a>\r\n\r\n                <Button\r\n                    disabled={isLoading}\r\n                    id=\"checkout-save-address\"\r\n                    type=\"submit\"\r\n                    variant={ButtonVariant.Primary}\r\n                >\r\n                    <TranslatedString id=\"address.save_address_action\" />\r\n                </Button>\r\n            </div>\r\n        </LoadingOverlay>\r\n    </Form>\r\n);\r\n\r\nconst SaveAddressForm = withLanguage(\r\n    withFormik<AddressFormProps & WithLanguageProps, AddressFormValues>({\r\n        handleSubmit: (values, { props: { onSaveAddress } }) => {\r\n            onSaveAddress(values);\r\n        },\r\n        mapPropsToValues: ({ defaultCountryCode = '' }) => ({\r\n            firstName: '',\r\n            lastName: '',\r\n            address1: '',\r\n            address2: '',\r\n            customFields: {},\r\n            country: '',\r\n            countryCode: defaultCountryCode,\r\n            stateOrProvince: '',\r\n            stateOrProvinceCode: '',\r\n            postalCode: '',\r\n            phone: '',\r\n            city: '',\r\n            company: '',\r\n            shouldSaveAddress: false,\r\n        }),\r\n        validationSchema: ({ language, getFields }: AddressFormProps & WithLanguageProps) =>\r\n            lazy<Partial<AddressFormValues>>((values) =>\r\n                getAddressFormFieldsValidationSchema({\r\n                    language,\r\n                    formFields: getFields(values && values.countryCode),\r\n                }),\r\n            ),\r\n    })(SaveAddress),\r\n);\r\n\r\nconst AddressFormModal: FunctionComponent<AddressFormModalProps> = ({\r\n    isOpen,\r\n    onAfterOpen,\r\n    onRequestClose,\r\n    ...addressFormProps\r\n}) => (\r\n    <Modal\r\n        additionalModalClassName=\"modal--medium\"\r\n        header={\r\n            <ModalHeader>\r\n                <TranslatedString id=\"address.add_address_heading\" />\r\n            </ModalHeader>\r\n        }\r\n        isOpen={isOpen}\r\n        onAfterOpen={onAfterOpen}\r\n        onRequestClose={onRequestClose}\r\n        shouldShowCloseButton={true}\r\n    >\r\n        <SaveAddressForm {...addressFormProps} onRequestClose={onRequestClose} />\r\n    </Modal>\r\n);\r\n\r\nexport default AddressFormModal;\r\n","import { CustomError, setPrototypeOf } from '../../common/error';\r\nimport { getLanguageService } from '../../locale';\r\n\r\nexport default class AssignItemInvalidAddressError extends CustomError {\r\n    constructor(data?: Error) {\r\n        super({\r\n            name: 'ASSIGN_ITEM_INVALID_ADDRESS',\r\n            message: getLanguageService().translate('shipping.assign_item_invalid_address_error'),\r\n            title: getLanguageService().translate(\r\n                'shipping.assign_item_invalid_address_error_heading',\r\n            ),\r\n            data,\r\n        });\r\n\r\n        setPrototypeOf(this, AssignItemInvalidAddressError.prototype);\r\n    }\r\n}\r\n","import { CustomError, setPrototypeOf } from '../../common/error';\r\nimport { getLanguageService } from '../../locale';\r\n\r\nexport default class AssignItemFailedError extends CustomError {\r\n    constructor(data: Error) {\r\n        super({\r\n            name: 'ASSIGN_ITEM_FAILED',\r\n            message: getLanguageService().translate('shipping.assign_item_error'),\r\n            data,\r\n        });\r\n\r\n        setPrototypeOf(this, AssignItemFailedError.prototype);\r\n    }\r\n}\r\n","import { Consignment } from '@bigcommerce/checkout-sdk';\r\nimport { find, includes } from 'lodash';\r\n\r\nexport default function findConsignment(\r\n    consignments: Consignment[],\r\n    itemId: string,\r\n): Consignment | undefined {\r\n    return find(consignments, (consignment) => includes(consignment.lineItemIds, itemId));\r\n}\r\n","import { Cart, Consignment, PhysicalItem } from '@bigcommerce/checkout-sdk';\r\nimport { isNil, reduce } from 'lodash';\r\n\r\nimport findConsignment from './findConsignment';\r\nimport ShippableItem from './ShippableItem';\r\n\r\nexport default function getShippableLineItems(\r\n    cart: Cart,\r\n    consignments: Consignment[],\r\n): ShippableItem[] {\r\n    return reduce(\r\n        (cart && cart.lineItems.physicalItems) || [],\r\n        (result, item, i) =>\r\n            !item.addedByPromotion && isNil(item.parentId)\r\n                ? result.concat(...splitItem(item, consignments, i))\r\n                : result,\r\n        [] as ShippableItem[],\r\n    );\r\n}\r\n\r\nfunction splitItem(\r\n    item: PhysicalItem,\r\n    consignments: Consignment[],\r\n    lineItemIndex: number,\r\n): ShippableItem[] {\r\n    let splitItems: ShippableItem[] = [];\r\n    const consignment = findConsignment(consignments, item.id as string);\r\n\r\n    for (let i = 0; i < item.quantity; i++) {\r\n        splitItems = splitItems.concat({\r\n            ...item,\r\n            key: `${item.variantId}-${item.productId}-${lineItemIndex}-${i}`,\r\n            consignment,\r\n            quantity: 1,\r\n        });\r\n    }\r\n\r\n    return splitItems;\r\n}\r\n","import { Address, CustomerAddress } from '@bigcommerce/checkout-sdk';\r\nimport React, { FunctionComponent, memo, useCallback } from 'react';\r\n\r\nimport { AddressSelect } from '../address';\r\n\r\nimport ShippableItem from './ShippableItem';\r\n\r\nexport interface ItemAddressSelectProps {\r\n    item: ShippableItem;\r\n    addresses: CustomerAddress[];\r\n    onSelectAddress(address: Address, itemId: string, itemKey: string): void;\r\n    onUseNewAddress(address: Address | undefined, itemId: string, itemKey: string): void;\r\n}\r\n\r\nconst ItemAddressSelect: FunctionComponent<ItemAddressSelectProps> = ({\r\n    item: { id, key, imageUrl, quantity, name, options, consignment },\r\n    addresses,\r\n    onSelectAddress,\r\n    onUseNewAddress,\r\n}) => {\r\n    const handleUseNewAddress = useCallback(\r\n        (address: Address) => {\r\n            onUseNewAddress(address, id as string, key);\r\n        },\r\n        [id, onUseNewAddress, key],\r\n    );\r\n\r\n    const handleSelectAddress = useCallback(\r\n        (address: Address) => {\r\n            onSelectAddress(address, id as string, key);\r\n        },\r\n        [id, key, onSelectAddress],\r\n    );\r\n\r\n    return (\r\n        <div className=\"consignment\">\r\n            <figure className=\"consignment-product-figure\">\r\n                {imageUrl && <img alt={name} src={imageUrl} />}\r\n            </figure>\r\n\r\n            <div className=\"consignment-product-body\">\r\n                <h4 className=\"optimizedCheckout-contentPrimary\">{`${quantity} x ${name}`}</h4>\r\n\r\n                {(options || []).map(({ name: optionName, value, nameId }) => (\r\n                    <ul\r\n                        className=\"product-options optimizedCheckout-contentSecondary\"\r\n                        data-test=\"consigment-item-product-options\"\r\n                        key={nameId}\r\n                    >\r\n                        <li className=\"product-option\">{`${optionName} ${value}`}</li>\r\n                    </ul>\r\n                ))}\r\n\r\n                <AddressSelect\r\n                    addresses={addresses}\r\n                    onSelectAddress={handleSelectAddress}\r\n                    onUseNewAddress={handleUseNewAddress}\r\n                    selectedAddress={consignment && consignment.shippingAddress}\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(ItemAddressSelect);\r\n","import { ShippingOption } from '@bigcommerce/checkout-sdk';\r\n\r\nexport default function getRecommendedShippingOption(\r\n    availableShippingOptions: ShippingOption[],\r\n): ShippingOption | undefined {\r\n    if (!availableShippingOptions) {\r\n        return;\r\n    }\r\n\r\n    return availableShippingOptions.find(\r\n        ({ isRecommended }: { isRecommended: any }) => isRecommended,\r\n    );\r\n}\r\n","import { ShippingOption } from '@bigcommerce/checkout-sdk';\r\nimport React, { FunctionComponent, memo, useCallback } from 'react';\r\n\r\nimport { EMPTY_ARRAY } from '../../common/utility';\r\nimport { Checklist, ChecklistItem } from '../../ui/form';\r\nimport { LoadingOverlay } from '../../ui/loading';\r\n\r\nimport StaticShippingOption from './StaticShippingOption';\r\n\r\ninterface ShippingOptionListItemProps {\r\n    consignmentId: string;\r\n    shippingOption: ShippingOption;\r\n}\r\n\r\nconst ShippingOptionListItem: FunctionComponent<ShippingOptionListItemProps> = ({\r\n    consignmentId,\r\n    shippingOption,\r\n}) => {\r\n    const renderLabel = useCallback(\r\n        () => (\r\n            <div className=\"shippingOptionLabel\">\r\n                <StaticShippingOption displayAdditionalInformation={true} method={shippingOption} />\r\n            </div>\r\n        ),\r\n        [shippingOption],\r\n    );\r\n\r\n    return (\r\n        <ChecklistItem\r\n            htmlId={`shippingOptionRadio-${consignmentId}-${shippingOption.id}`}\r\n            label={renderLabel}\r\n            value={shippingOption.id}\r\n        />\r\n    );\r\n};\r\n\r\nexport interface ShippingOptionListProps {\r\n    consignmentId: string;\r\n    inputName: string;\r\n    isLoading: boolean;\r\n    selectedShippingOptionId?: string;\r\n    shippingOptions?: ShippingOption[];\r\n    onSelectedOption(consignmentId: string, shippingOptionId: string): void;\r\n}\r\n\r\nconst ShippingOptionsList: FunctionComponent<ShippingOptionListProps> = ({\r\n    consignmentId,\r\n    inputName,\r\n    isLoading,\r\n    shippingOptions = EMPTY_ARRAY,\r\n    selectedShippingOptionId,\r\n    onSelectedOption,\r\n}) => {\r\n    const handleSelect = useCallback(\r\n        (value: string) => {\r\n            onSelectedOption(consignmentId, value);\r\n        },\r\n        [consignmentId, onSelectedOption],\r\n    );\r\n\r\n    if (!shippingOptions.length) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <LoadingOverlay isLoading={isLoading}>\r\n            <Checklist\r\n                aria-live=\"polite\"\r\n                defaultSelectedItemId={selectedShippingOptionId}\r\n                name={inputName}\r\n                onSelect={handleSelect}\r\n            >\r\n                {shippingOptions.map((shippingOption) => (\r\n                    <ShippingOptionListItem\r\n                        consignmentId={consignmentId}\r\n                        key={shippingOption.id}\r\n                        shippingOption={shippingOption}\r\n                    />\r\n                ))}\r\n            </Checklist>\r\n        </LoadingOverlay>\r\n    );\r\n};\r\n\r\nexport default memo(ShippingOptionsList);\r\n","import { CheckoutSelectors, Consignment } from '@bigcommerce/checkout-sdk';\r\nimport { FormikProps, withFormik } from 'formik';\r\nimport { noop } from 'lodash';\r\nimport React, { PureComponent, ReactNode } from 'react';\r\n\r\nimport { AnalyticsContextProps } from '@bigcommerce/checkout/analytics';\r\nimport { ChecklistSkeleton } from '@bigcommerce/checkout/ui';\r\n\r\nimport { StaticAddress } from '../../address';\r\nimport { withAnalytics } from '../../analytics';\r\nimport { TranslatedString } from '../../locale';\r\nimport getRecommendedShippingOption from '../getRecommendedShippingOption';\r\nimport StaticConsignmentItemList from '../StaticConsignmentItemList';\r\n\r\nimport { ShippingOptionsProps, WithCheckoutShippingOptionsProps } from './ShippingOptions';\r\nimport './ShippingOptionsForm.scss';\r\nimport ShippingOptionsList from './ShippingOptionsList';\r\n\r\nexport type ShippingOptionsFormProps = ShippingOptionsProps & WithCheckoutShippingOptionsProps & AnalyticsContextProps;\r\n\r\nclass ShippingOptionsForm extends PureComponent<\r\n    ShippingOptionsFormProps & FormikProps<ShippingOptionsFormValues>\r\n> {\r\n    private unsubscribe?: () => void;\r\n\r\n    componentDidMount(): void {\r\n        const { subscribeToConsignments } = this.props;\r\n\r\n        this.unsubscribe = subscribeToConsignments(this.selectDefaultShippingOptions);\r\n    }\r\n\r\n    componentDidUpdate(): void {\r\n        const {\r\n            analyticsTracker,\r\n            consignments,\r\n            shouldShowShippingOptions\r\n        } = this.props;\r\n        \r\n        if (consignments?.length && shouldShowShippingOptions) {\r\n            analyticsTracker.showShippingMethods();\r\n        }\r\n    }\r\n\r\n    componentWillUnmount(): void {\r\n        if (this.unsubscribe) {\r\n            this.unsubscribe();\r\n            this.unsubscribe = undefined;\r\n        }\r\n    }\r\n\r\n    render(): ReactNode {\r\n        const {\r\n            consignments,\r\n            isMultiShippingMode,\r\n            selectShippingOption,\r\n            isLoading,\r\n            shouldShowShippingOptions,\r\n            invalidShippingMessage,\r\n            methodId\r\n        } = this.props;\r\n\r\n        if (!consignments?.length || !shouldShowShippingOptions) {\r\n            return (\r\n                <ChecklistSkeleton\r\n                    additionalClassName=\"shippingOptions-skeleton\"\r\n                    isLoading={isLoading()}\r\n                    rows={2}\r\n                >\r\n                    {this.renderNoShippingOptions(\r\n                        <TranslatedString\r\n                            id={\r\n                                methodId || isMultiShippingMode\r\n                                    ? 'shipping.select_shipping_address_text'\r\n                                    : 'shipping.enter_shipping_address_text'\r\n                            }\r\n                        />,\r\n                    )}\r\n                </ChecklistSkeleton>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <>\r\n                {consignments.map((consignment) => (\r\n                    <div className=\"shippingOptions-container form-fieldset\" key={consignment.id}>\r\n                        {isMultiShippingMode && this.renderConsignment(consignment)}\r\n\r\n                        <ShippingOptionsList\r\n                            consignmentId={consignment.id}\r\n                            inputName={getRadioInputName(consignment.id)}\r\n                            isLoading={isLoading(consignment.id)}\r\n                            onSelectedOption={selectShippingOption}\r\n                            selectedShippingOptionId={\r\n                                consignment.selectedShippingOption &&\r\n                                consignment.selectedShippingOption.id\r\n                            }\r\n                            shippingOptions={consignment.availableShippingOptions}\r\n                        />\r\n\r\n                        {(!consignment.availableShippingOptions ||\r\n                            !consignment.availableShippingOptions.length) && (\r\n                            <ChecklistSkeleton\r\n                                additionalClassName=\"shippingOptions-skeleton\"\r\n                                isLoading={isLoading(consignment.id)}\r\n                                rows={2}\r\n                            >\r\n                                {this.renderNoShippingOptions(invalidShippingMessage)}\r\n                            </ChecklistSkeleton>\r\n                        )}\r\n                    </div>\r\n                ))}\r\n            </>\r\n        );\r\n    }\r\n\r\n    private selectDefaultShippingOptions: (state: CheckoutSelectors) => void = async ({ data }) => {\r\n        const { selectShippingOption, setFieldValue } = this.props;\r\n\r\n        const consignment = (data.getConsignments() || []).find(\r\n            ({ selectedShippingOption, availableShippingOptions: shippingOptions }) =>\r\n                !selectedShippingOption && shippingOptions,\r\n        );\r\n\r\n        if (!consignment || !consignment.availableShippingOptions) {\r\n            return;\r\n        }\r\n\r\n        const { availableShippingOptions, id } = consignment;\r\n        const recommendedOption = getRecommendedShippingOption(availableShippingOptions);\r\n        const singleShippingOption =\r\n            availableShippingOptions.length === 1 && availableShippingOptions[0];\r\n        const defaultShippingOption = recommendedOption || singleShippingOption;\r\n\r\n        if (!defaultShippingOption) {\r\n            return;\r\n        }\r\n\r\n        await selectShippingOption(id, defaultShippingOption.id);\r\n        setFieldValue(`shippingOptionIds.${id}`, defaultShippingOption.id);\r\n    };\r\n\r\n    private renderNoShippingOptions(message: ReactNode): ReactNode {\r\n        return (\r\n            <div className=\"shippingOptions-panel optimizedCheckout-overlay\">\r\n                <p\r\n                    aria-live=\"polite\"\r\n                    className=\"shippingOptions-panel-message optimizedCheckout-primaryContent\"\r\n                    role=\"alert\"\r\n                >\r\n                    {message}\r\n                </p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    private renderConsignment(consignment: Consignment): ReactNode {\r\n        const { cart } = this.props;\r\n\r\n        return (\r\n            <div className=\"staticConsignment\">\r\n                <strong>\r\n                    <TranslatedString id=\"shipping.shipping_address_heading\" />\r\n                </strong>\r\n\r\n                <StaticAddress address={consignment.shippingAddress} />\r\n\r\n                <StaticConsignmentItemList cart={cart} consignment={consignment} />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nfunction getRadioInputName(consignmentId: string): string {\r\n    return `shippingOptionIds.${consignmentId}`;\r\n}\r\n\r\nexport interface ShippingOptionsFormValues {\r\n    shippingOptionIds: {\r\n        [shippingOptionIds: string]: string;\r\n    };\r\n}\r\n\r\nexport default withAnalytics(withFormik<ShippingOptionsFormProps, ShippingOptionsFormValues>({\r\n    handleSubmit: noop,\r\n    mapPropsToValues({ consignments }) {\r\n        const shippingOptionIds: { [id: string]: string } = {};\r\n\r\n        (consignments || []).forEach((consignment) => {\r\n            shippingOptionIds[consignment.id] = consignment.selectedShippingOption\r\n                ? consignment.selectedShippingOption.id\r\n                : '';\r\n        });\r\n\r\n        return { shippingOptionIds };\r\n    },\r\n})(ShippingOptionsForm));\r\n","import { Cart, CheckoutSelectors, Consignment } from '@bigcommerce/checkout-sdk';\r\nimport { map, sortBy, uniq } from 'lodash';\r\nimport { createSelector } from 'reselect';\r\n\r\nimport { CheckoutContextProps, withCheckout } from '../../checkout';\r\nimport getShippableLineItems from '../getShippableLineItems';\r\nimport getShippingMethodId from '../getShippingMethodId';\r\n\r\nimport ShippingOptionsForm from './ShippingOptionsForm';\r\n\r\nexport interface ShippingOptionsProps {\r\n    isMultiShippingMode: boolean;\r\n    isUpdatingAddress?: boolean;\r\n    shouldShowShippingOptions: boolean;\r\n}\r\n\r\nexport interface WithCheckoutShippingOptionsProps {\r\n    invalidShippingMessage: string;\r\n    methodId?: string;\r\n    consignments?: Consignment[];\r\n    cart: Cart;\r\n    isSelectingShippingOption(consignmentId?: string): boolean;\r\n    subscribeToConsignments(subscriber: (state: CheckoutSelectors) => void): () => void;\r\n    selectShippingOption(consignmentId: string, optionId: string): Promise<CheckoutSelectors>;\r\n    isLoading(consignmentId?: string): boolean;\r\n}\r\n\r\nconst subscribeToConsignmentsSelector = createSelector(\r\n    ({ checkoutService }: CheckoutContextProps) => checkoutService.subscribe,\r\n    (subscribe) => (subscriber: (state: CheckoutSelectors) => void) => {\r\n        return subscribe(subscriber, ({ data }) => data.getConsignments());\r\n    },\r\n);\r\n\r\nconst isLoadingSelector = createSelector(\r\n    (_: CheckoutSelectors, { isUpdatingAddress }: ShippingOptionsProps) => isUpdatingAddress,\r\n    ({ statuses }: CheckoutSelectors) => statuses.isLoadingShippingOptions,\r\n    ({ statuses }: CheckoutSelectors) => statuses.isSelectingShippingOption,\r\n    ({ statuses }: CheckoutSelectors) => statuses.isUpdatingConsignment,\r\n    ({ statuses }: CheckoutSelectors) => statuses.isCreatingConsignments,\r\n    (\r\n        isUpdatingAddress,\r\n        isLoadingShippingOptions,\r\n        isSelectingShippingOption,\r\n        isUpdatingConsignment,\r\n        isCreatingConsignments,\r\n    ) => {\r\n        return (consignmentId?: string) => {\r\n            return (\r\n                isUpdatingAddress ||\r\n                isLoadingShippingOptions() ||\r\n                isSelectingShippingOption(consignmentId) ||\r\n                isUpdatingConsignment(consignmentId) ||\r\n                isCreatingConsignments()\r\n            );\r\n        };\r\n    },\r\n);\r\n\r\nconst sortConsignments = (cart: Cart, unsortedConsignments: Consignment[]): Consignment[] => {\r\n    if (unsortedConsignments.length < 2) {\r\n        return unsortedConsignments;\r\n    }\r\n\r\n    const shippableItems = getShippableLineItems(cart, unsortedConsignments);\r\n    const consignmentsOrder = uniq(map(shippableItems, 'consignment.id'));\r\n\r\n    return sortBy(unsortedConsignments, (consignment: any) => consignmentsOrder.indexOf(consignment.id));\r\n};\r\n\r\n\r\n\r\nexport function mapToShippingOptions(\r\n    { checkoutService, checkoutState }: CheckoutContextProps,\r\n    props: ShippingOptionsProps,\r\n): WithCheckoutShippingOptionsProps | null {\r\n    const {\r\n        data: { getCart, getConsignments, getConfig, getCustomer, getCheckout },\r\n        statuses: { isSelectingShippingOption },\r\n    } = checkoutState;\r\n\r\n    const customer = getCustomer();\r\n    const cart = getCart();\r\n    const config = getConfig();\r\n    const checkout = getCheckout();\r\n\r\n    if (!config || !checkout || !customer || !cart) {\r\n        return null;\r\n    }\r\n\r\n    const consignments = sortConsignments(cart, getConsignments() || []);\r\n    const methodId = getShippingMethodId(checkout);\r\n    const { shippingQuoteFailedMessage } = config.checkoutSettings;\r\n\r\n    if(consignments?.length && !!consignments[0])\r\n    {\r\n        const { availableShippingOptions } = consignments[0];\n\r\n        if(availableShippingOptions?.length)\r\n        {\r\n            const expressShipping = availableShippingOptions.find( option => option.description === 'FedEx (FedEx Express Saver)' );\r\n            const standardShipping = availableShippingOptions.find( option => option.description === 'FedEx (Ground Home Delivery)' );\r\n\r\n            if(expressShipping && standardShipping)\r\n            {\r\n                const delta = Math.ceil((expressShipping.cost - standardShipping.cost) * 100) / 100; // Round to nearest hundredth\r\n                // Create coupon\r\n\r\n                const { coupons, id: cartId } = cart;\r\n                let count = 0;\r\n\r\n                if(count < 1){\r\n                    if(!coupons?.length)\r\n                    {\r\n                        count++;\n\r\n                        (async () => {\r\n                            await fetch('https://uox63mtruzhalf2xznkjsri63i0eukwc.lambda-url.us-west-1.on.aws', {\r\n                                method: 'POST',\r\n                                mode: 'cors',\r\n                                body: JSON.stringify({\r\n                                    cartId,\r\n                                    shippingRateDelta: delta\r\n                                })\r\n                            })\r\n                            .then(res => res.json())\r\n                            .then(data => {\r\n                                if(data?.code?.length){\r\n                                    checkoutService.applyCoupon(data.code)\r\n                                }\r\n                            });\r\n                        })()\r\n                    }\r\n                    else\r\n                    {\r\n                        const existingCoupon = coupons.find(coupon => coupon.code === cartId);\n\r\n                        if(existingCoupon)\r\n                        {\r\n                            if(existingCoupon.discountedAmount.toFixed(4) !== delta.toFixed(4))\r\n                            {\r\n                                count++;\n\r\n                                ( async() => {\r\n                                    checkoutService.removeCoupon(cartId);\r\n                                    await fetch('https://uox63mtruzhalf2xznkjsri63i0eukwc.lambda-url.us-west-1.on.aws', {\r\n                                        method: 'POST',\r\n                                        mode: 'cors',\r\n                                        body: JSON.stringify({\r\n                                            cartId,\r\n                                            shippingRateDelta: delta\r\n                                        })\r\n                                    })\r\n                                    .then(res => res.json())\r\n                                    .then(data => {\r\n                                        if(data?.code?.length){\r\n                                            checkoutService.applyCoupon(data.code)\r\n                                        }\r\n                                    });\r\n                                })()\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    return {\r\n        cart,\r\n        consignments,\r\n        invalidShippingMessage: shippingQuoteFailedMessage,\r\n        isLoading: isLoadingSelector(checkoutState, props),\r\n        isSelectingShippingOption,\r\n        methodId,\r\n        selectShippingOption: checkoutService.selectConsignmentShippingOption,\r\n        subscribeToConsignments: subscribeToConsignmentsSelector({\r\n            checkoutService,\r\n            checkoutState,\r\n        }),\r\n    };\r\n}\r\n\r\nexport default withCheckout(mapToShippingOptions)(ShippingOptionsForm);\r\n","import React, { PureComponent, ReactNode } from 'react';\r\n\r\nimport { TranslatedString } from '../locale';\r\nimport { OrderComments } from '../orderComments';\r\nimport { Alert, AlertType } from '../ui/alert';\r\nimport { Button, ButtonVariant } from '../ui/button';\r\nimport { Fieldset, Legend } from '../ui/form';\r\n\r\nimport { ShippingOptions } from './shippingOption';\r\n\r\nexport interface ShippingFormFooterProps {\r\n    cartHasChanged: boolean;\r\n    isMultiShippingMode: boolean;\r\n    shouldShowOrderComments: boolean;\r\n    shouldShowShippingOptions?: boolean;\r\n    shouldDisableSubmit: boolean;\r\n    isLoading: boolean;\r\n}\r\n\r\nclass ShippingFormFooter extends PureComponent<ShippingFormFooterProps> {\r\n    render(): ReactNode {\r\n        const {\r\n            cartHasChanged,\r\n            isMultiShippingMode,\r\n            shouldShowOrderComments,\r\n            shouldShowShippingOptions = true,\r\n            shouldDisableSubmit,\r\n            isLoading,\r\n        } = this.props;\r\n\r\n        return (\r\n            <>\r\n                <Fieldset\r\n                    id=\"checkout-shipping-options\"\r\n                    legend={\r\n                        <>\r\n                            <Legend>\r\n                                <TranslatedString id=\"shipping.shipping_method_label\" />\r\n                            </Legend>\r\n\r\n                            {cartHasChanged && (\r\n                                <Alert type={AlertType.Error}>\r\n                                    <strong>\r\n                                        <TranslatedString id=\"shipping.cart_change_error\" />\r\n                                    </strong>\r\n                                </Alert>\r\n                            )}\r\n                        </>\r\n                    }\r\n                >\r\n                    <ShippingOptions\r\n                        isMultiShippingMode={isMultiShippingMode}\r\n                        isUpdatingAddress={isLoading}\r\n                        shouldShowShippingOptions={shouldShowShippingOptions}\r\n                    />\r\n                </Fieldset>\r\n\r\n                {shouldShowOrderComments && <OrderComments />}\r\n\r\n                <div className=\"form-actions\">\r\n                    <Button\r\n                        disabled={shouldDisableSubmit}\r\n                        id=\"checkout-shipping-continue\"\r\n                        isLoading={isLoading}\r\n                        type=\"submit\"\r\n                        variant={ButtonVariant.Primary}\r\n                    >\r\n                        <TranslatedString id=\"common.continue_action\" />\r\n                    </Button>\r\n                </div>\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default ShippingFormFooter;\r\n","import { Address, Cart, Consignment } from '@bigcommerce/checkout-sdk';\r\n\r\nimport { isEqualAddress } from '../address';\r\n\r\nimport findConsignment from './findConsignment';\r\nimport ShippableItem from './ShippableItem';\r\n\r\nexport interface UpdateItemParams {\r\n    updatedItemIndex: number;\r\n    address: Address;\r\n}\r\n\r\nexport default function updateShippableItems(\r\n    items: ShippableItem[],\r\n    { updatedItemIndex, address }: UpdateItemParams,\r\n    { cart, consignments }: { cart?: Cart; consignments?: Consignment[] },\r\n): ShippableItem[] | undefined {\r\n    if (updatedItemIndex < 0 || updatedItemIndex >= items.length || !cart) {\r\n        return;\r\n    }\r\n\r\n    const cartItemIds = cart.lineItems.physicalItems.map(({ id }) => id);\r\n\r\n    const updatedConsignment = (consignments || []).find((consignment) =>\r\n        isEqualAddress(consignment.shippingAddress, address),\r\n    );\r\n\r\n    const newId = findNewItemId(items[updatedItemIndex], cart, updatedConsignment);\r\n\r\n    return items.map((item, i) => {\r\n        if ((newId && !cartItemIds.includes(item.id)) || i === updatedItemIndex) {\r\n            const itemId = newId ?? item.id;\r\n\r\n            return {\r\n                ...item,\r\n                id: itemId,\r\n                consignment: findConsignment(consignments || [], itemId as string),\r\n            };\r\n        }\r\n\r\n        return item;\r\n    });\r\n}\r\n\r\nfunction findNewItemId(\r\n    item: ShippableItem,\r\n    cart?: Cart,\r\n    consignment?: Consignment,\r\n): string | undefined {\r\n    if (!cart || !consignment) {\r\n        return;\r\n    }\r\n\r\n    const { physicalItems } = cart.lineItems;\r\n    const matchingCartItems = physicalItems.filter(\r\n        ({ productId, variantId }) => productId === item.productId && variantId === item.variantId,\r\n    );\r\n\r\n    const matchingCartItemIds = matchingCartItems.map(({ id }) => id);\r\n\r\n    return consignment.lineItemIds.find((id) => matchingCartItemIds.includes(id));\r\n}\r\n","import {\r\n    Address,\r\n    AddressRequestBody,\r\n    Cart,\r\n    CheckoutSelectors,\r\n    CheckoutStoreSelector,\r\n    Consignment,\r\n    ConsignmentAssignmentRequestBody,\r\n    Country,\r\n    CustomerAddress,\r\n    FormField,\r\n} from '@bigcommerce/checkout-sdk';\r\nimport { FormikProps, withFormik } from 'formik';\r\nimport React, { PureComponent, ReactNode } from 'react';\r\n\r\nimport {\r\n    AddressFormModal,\r\n    AddressFormValues,\r\n    isValidAddress,\r\n    mapAddressFromFormValues,\r\n} from '../address';\r\nimport { preventDefault } from '../common/dom';\r\nimport { ErrorModal } from '../common/error';\r\nimport { TranslatedLink, TranslatedString, withLanguage, WithLanguageProps } from '../locale';\r\nimport { Form } from '../ui/form';\r\n\r\nimport { AssignItemFailedError, AssignItemInvalidAddressError } from './errors';\r\nimport getShippableItemsCount from './getShippableItemsCount';\r\nimport getShippableLineItems from './getShippableLineItems';\r\nimport hasSelectedShippingOptions from './hasSelectedShippingOptions';\r\nimport hasUnassignedLineItems from './hasUnassignedLineItems';\r\nimport ItemAddressSelect from './ItemAddressSelect';\r\nimport ShippableItem from './ShippableItem';\r\nimport ShippingFormFooter from './ShippingFormFooter';\r\nimport updateShippableItems from './updateShippableItems';\r\n\r\nexport interface MultiShippingFormProps {\r\n    addresses: CustomerAddress[];\r\n    cart: Cart;\r\n    cartHasChanged: boolean;\r\n    consignments: Consignment[];\r\n    customerMessage: string;\r\n    isGuest: boolean;\r\n    isLoading: boolean;\r\n    shouldShowOrderComments: boolean;\r\n    defaultCountryCode?: string;\r\n    countries?: Country[];\r\n    countriesWithAutocomplete: string[];\r\n    googleMapsApiKey?: string;\r\n    shouldShowAddAddressInCheckout: boolean;\r\n    useFloatingLabel?: boolean;\r\n    assignItem(consignment: ConsignmentAssignmentRequestBody): Promise<CheckoutSelectors>;\r\n    onCreateAccount(): void;\r\n    createCustomerAddress(address: AddressRequestBody): void;\r\n    onSignIn(): void;\r\n    getFields(countryCode?: string): FormField[];\r\n    onSubmit(values: MultiShippingFormValues): void;\r\n    onUnhandledError(error: Error): void;\r\n    onUseNewAddress(address: Address, itemId: string): void;\r\n}\r\n\r\ninterface ShippableItemId {\r\n    key: string;\r\n    itemId: string;\r\n}\r\n\r\nexport interface MultiShippingFormState {\r\n    items: ShippableItem[];\r\n    itemAddingAddress?: ShippableItemId;\r\n    createCustomerAddressError?: Error;\r\n}\r\n\r\nclass MultiShippingForm extends PureComponent<\r\n    MultiShippingFormProps & WithLanguageProps & FormikProps<MultiShippingFormValues>,\r\n    MultiShippingFormState\r\n> {\r\n    static getDerivedStateFromProps(\r\n        { cart, consignments }: MultiShippingFormProps,\r\n        state: MultiShippingFormState,\r\n    ) {\r\n        if (!state || !state.items || getShippableItemsCount(cart) !== state.items.length) {\r\n            return { items: getShippableLineItems(cart, consignments) };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    state: MultiShippingFormState = { items: [] };\r\n\r\n    render(): ReactNode {\r\n        const {\r\n            addresses,\r\n            consignments,\r\n            cart,\r\n            isGuest,\r\n            onSignIn,\r\n            onCreateAccount,\r\n            cartHasChanged,\r\n            shouldShowOrderComments,\r\n            isLoading,\r\n            getFields,\r\n            defaultCountryCode,\r\n            countries,\r\n            countriesWithAutocomplete,\r\n            googleMapsApiKey,\r\n            useFloatingLabel,\r\n        } = this.props;\r\n\r\n        const { items, itemAddingAddress, createCustomerAddressError } = this.state;\r\n\r\n        if (isGuest) {\r\n            return (\r\n                <div className=\"checkout-step-info\">\r\n                    <TranslatedString id=\"shipping.multishipping_guest_intro\" />{' '}\r\n                    <a\r\n                        data-test=\"shipping-sign-in-link\"\r\n                        href=\"#\"\r\n                        onClick={preventDefault(onSignIn)}\r\n                    >\r\n                        <TranslatedString id=\"shipping.multishipping_guest_sign_in\" />\r\n                    </a>{' '}\r\n                    <TranslatedLink\r\n                        id=\"shipping.multishipping_guest_create\"\r\n                        onClick={onCreateAccount}\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <>\r\n                <ErrorModal\r\n                    error={createCustomerAddressError}\r\n                    message={\r\n                        <>\r\n                            <TranslatedString id=\"address.consignment_address_updated_text\" />{' '}\r\n                            <TranslatedString id=\"customer.create_address_error\" />\r\n                        </>\r\n                    }\r\n                    onClose={this.handleCloseErrorModal}\r\n                    shouldShowErrorCode={false}\r\n                />\r\n                <AddressFormModal\r\n                    countries={countries}\r\n                    countriesWithAutocomplete={countriesWithAutocomplete}\r\n                    defaultCountryCode={defaultCountryCode}\r\n                    getFields={getFields}\r\n                    googleMapsApiKey={googleMapsApiKey}\r\n                    isLoading={isLoading}\r\n                    isOpen={!!itemAddingAddress}\r\n                    onRequestClose={this.handleCloseAddAddressForm}\r\n                    onSaveAddress={this.handleSaveAddress}\r\n                    useFloatingLabel={useFloatingLabel}\r\n                />\r\n\r\n                <Form>\r\n                    <ul className=\"consignmentList\">\r\n                        {items.map((item) => (\r\n                            <li key={item.key}>\r\n                                <ItemAddressSelect\r\n                                    addresses={addresses}\r\n                                    item={item}\r\n                                    onSelectAddress={this.handleSelectAddress}\r\n                                    onUseNewAddress={this.handleUseNewAddress}\r\n                                />\r\n                            </li>\r\n                        ))}\r\n                    </ul>\r\n\r\n                    <ShippingFormFooter\r\n                        cartHasChanged={cartHasChanged}\r\n                        isLoading={isLoading}\r\n                        isMultiShippingMode={true}\r\n                        shouldDisableSubmit={this.shouldDisableSubmit()}\r\n                        shouldShowOrderComments={shouldShowOrderComments}\r\n                        shouldShowShippingOptions={\r\n                            !hasUnassignedLineItems(consignments, cart.lineItems)\r\n                        }\r\n                    />\r\n                </Form>\r\n            </>\r\n        );\r\n    }\r\n\r\n    private handleCloseErrorModal: () => void = () => {\r\n        this.setState({ createCustomerAddressError: undefined });\r\n    };\r\n\r\n    private handleSaveAddress: (address: AddressFormValues) => void = async (address) => {\r\n        const { createCustomerAddress } = this.props;\r\n        const { itemAddingAddress } = this.state;\r\n\r\n        if (!itemAddingAddress) {\r\n            return;\r\n        }\r\n\r\n        const shippingAddress = mapAddressFromFormValues(address);\r\n\r\n        await this.handleSelectAddress(\r\n            shippingAddress,\r\n            itemAddingAddress.itemId,\r\n            itemAddingAddress.key,\r\n        );\r\n\r\n        try {\r\n            await createCustomerAddress(shippingAddress);\r\n        } catch (error) {\r\n            if (error instanceof Error) {\r\n                this.setState({ createCustomerAddressError: error });\r\n            }\r\n        }\r\n\r\n        this.setState({\r\n            itemAddingAddress: undefined,\r\n        });\r\n    };\r\n\r\n    private handleUseNewAddress: (address: Address, itemId: string, itemKey: string) => void = (\r\n        address,\r\n        itemId,\r\n        itemKey,\r\n    ) => {\r\n        const { onUseNewAddress, shouldShowAddAddressInCheckout } = this.props;\r\n\r\n        if (!shouldShowAddAddressInCheckout) {\r\n            onUseNewAddress(address, itemId);\r\n\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            itemAddingAddress: {\r\n                key: itemKey,\r\n                itemId,\r\n            },\r\n        });\r\n    };\r\n\r\n    private handleCloseAddAddressForm: () => void = () => {\r\n        this.setState({\r\n            itemAddingAddress: undefined,\r\n        });\r\n    };\r\n\r\n    private handleSelectAddress: (\r\n        address: Address,\r\n        itemId: string,\r\n        itemKey: string,\r\n    ) => Promise<void> = async (address, itemId, itemKey) => {\r\n        const { assignItem, onUnhandledError, getFields } = this.props;\r\n\r\n        if (!isValidAddress(address, getFields(address.countryCode))) {\r\n            return onUnhandledError(new AssignItemInvalidAddressError());\r\n        }\r\n\r\n        try {\r\n            const { data } = await assignItem({\r\n                address,\r\n                lineItems: [\r\n                    {\r\n                        itemId,\r\n                        quantity: 1,\r\n                    },\r\n                ],\r\n            });\r\n\r\n            this.syncItems(itemKey, address, data);\r\n        } catch (error) {\r\n            if (error instanceof Error) {\r\n                onUnhandledError(new AssignItemFailedError(error));\r\n            }\r\n        }\r\n    };\r\n\r\n    private shouldDisableSubmit: () => boolean = () => {\r\n        const { isLoading, consignments } = this.props;\r\n\r\n        return isLoading || !hasSelectedShippingOptions(consignments);\r\n    };\r\n\r\n    private syncItems: (key: string, address: Address, data: CheckoutStoreSelector) => void = (\r\n        key,\r\n        address,\r\n        data,\r\n    ) => {\r\n        const { items: currentItems } = this.state;\r\n        const items = updateShippableItems(\r\n            currentItems,\r\n            {\r\n                updatedItemIndex: currentItems.findIndex((item) => item.key === key),\r\n                address,\r\n            },\r\n            {\r\n                cart: data.getCart(),\r\n                consignments: data.getConsignments(),\r\n            },\r\n        );\r\n\r\n        if (items) {\r\n            this.setState({ items });\r\n        }\r\n    };\r\n}\r\n\r\nexport interface MultiShippingFormValues {\r\n    orderComment: string;\r\n}\r\n\r\nexport default withLanguage(\r\n    withFormik<MultiShippingFormProps & WithLanguageProps, MultiShippingFormValues>({\r\n        handleSubmit: (values, { props: { onSubmit } }) => {\r\n            onSubmit(values);\r\n        },\r\n        mapPropsToValues: ({ customerMessage }) => ({\r\n            orderComment: customerMessage,\r\n        }),\r\n        enableReinitialize: true,\r\n    })(MultiShippingForm),\r\n);\r\n","import React, { FunctionComponent, memo, useMemo } from 'react';\r\n\r\nimport { TranslatedString } from '../locale';\r\nimport { CheckboxFormField } from '../ui/form';\r\n\r\nexport interface BillingSameAsShippingFieldProps {\r\n    onChange?(isChecked: boolean): void;\r\n}\r\n\r\nconst BillingSameAsShippingField: FunctionComponent<BillingSameAsShippingFieldProps> = ({\r\n    onChange,\r\n}) => {\r\n    const labelContent = useMemo(\r\n        () => <TranslatedString id=\"billing.use_shipping_address_label\" />,\r\n        [],\r\n    );\r\n\r\n    return (\r\n        <CheckboxFormField\r\n            id=\"sameAsBilling\"\r\n            labelContent={labelContent}\r\n            name=\"billingSameAsShipping\"\r\n            onChange={onChange}\r\n        />\r\n    );\r\n};\r\n\r\nexport default memo(BillingSameAsShippingField);\r\n","import {\r\n    CheckoutSelectors,\r\n    FormField,\r\n    ShippingInitializeOptions,\r\n    ShippingRequestOptions,\r\n} from '@bigcommerce/checkout-sdk';\r\nimport { noop } from 'lodash';\r\nimport React, { PureComponent, ReactNode } from 'react';\r\n\r\nimport { DynamicFormField, Fieldset } from '../ui/form';\r\n\r\nexport interface RemoteShippingAddressProps {\r\n    containerId: string;\r\n    methodId: string;\r\n    formFields: FormField[];\r\n    useFloatingLabel?: boolean;\r\n    deinitialize(options?: ShippingRequestOptions): Promise<CheckoutSelectors>;\r\n    initialize(options?: ShippingInitializeOptions): Promise<CheckoutSelectors>;\r\n    onUnhandledError?(error: Error): void;\r\n    onFieldChange(fieldName: string, value: string): void;\r\n}\r\n\r\nclass RemoteShippingAddress extends PureComponent<RemoteShippingAddressProps> {\r\n    async componentDidMount(): Promise<void> {\r\n        const { initialize, methodId, onUnhandledError = noop } = this.props;\r\n\r\n        try {\r\n            await initialize({ methodId });\r\n        } catch (error) {\r\n            onUnhandledError(error);\r\n        }\r\n    }\r\n\r\n    async componentWillUnmount(): Promise<void> {\r\n        const { deinitialize, methodId, onUnhandledError = noop } = this.props;\r\n\r\n        try {\r\n            await deinitialize({ methodId });\r\n        } catch (error) {\r\n            onUnhandledError(error);\r\n        }\r\n    }\r\n\r\n    render(): ReactNode {\r\n        const { containerId, formFields, methodId, useFloatingLabel } = this.props;\r\n\r\n        return (\r\n            <>\r\n                <div\r\n                    className={`widget address-widget widget--${methodId}`}\r\n                    id={containerId}\r\n                    tabIndex={-1}\r\n                />\r\n                <Fieldset>\r\n                    {formFields\r\n                        .filter(({ custom }) => custom)\r\n                        .map((field) => (\r\n                            <DynamicFormField\r\n                                field={field}\r\n                                key={`${field.id}-${field.name}`}\r\n                                onChange={this.handleFieldValueChange(field.name)}\r\n                                parentFieldName=\"shippingAddress.customFields\"\r\n                                useFloatingLabel={useFloatingLabel}\r\n                            />\r\n                        ))}\r\n                </Fieldset>\r\n            </>\r\n        );\r\n    }\r\n\r\n    private handleFieldValueChange: (name: string) => (value: string) => void =\r\n        (name) => (value) => {\r\n            const { onFieldChange } = this.props;\r\n\r\n            onFieldChange(name, value);\r\n        };\r\n}\r\n\r\nexport default RemoteShippingAddress;\r\n","import {\r\n    Address,\r\n    Consignment,\r\n    Country,\r\n    CustomerAddress,\r\n    FormField,\r\n} from '@bigcommerce/checkout-sdk';\r\nimport React, { Component, ReactNode } from 'react';\r\n\r\nimport { AddressForm, AddressSelect, isValidCustomerAddress } from '../address';\r\nimport { connectFormik, ConnectFormikProps } from '../common/form';\r\nimport { Fieldset } from '../ui/form';\r\nimport { LoadingOverlay } from '../ui/loading';\r\n\r\nimport { SingleShippingFormValues } from './SingleShippingForm';\r\n\r\nexport interface ShippingAddressFormProps {\r\n    addresses: CustomerAddress[];\r\n    address?: Address;\r\n    consignments: Consignment[];\r\n    countries?: Country[];\r\n    countriesWithAutocomplete: string[];\r\n    googleMapsApiKey?: string;\r\n    isLoading: boolean;\r\n    formFields: FormField[];\r\n    shouldShowSaveAddress?: boolean;\r\n    useFloatingLabel?: boolean;\r\n    onUseNewAddress(): void;\r\n    onFieldChange(fieldName: string, value: string): void;\r\n    onAddressSelect(address: Address): void;\r\n    disabledFields?: boolean;\r\n}\r\n\r\nconst addressFieldName = 'shippingAddress';\r\n\r\nclass ShippingAddressForm extends Component<\r\n    ShippingAddressFormProps & ConnectFormikProps<SingleShippingFormValues>\r\n> {\r\n    render(): ReactNode {\r\n        const {\r\n            addresses,\r\n            address: shippingAddress,\r\n            onAddressSelect,\r\n            onUseNewAddress,\r\n            shouldShowSaveAddress,\r\n            countries,\r\n            countriesWithAutocomplete,\r\n            formFields,\r\n            isLoading,\r\n            googleMapsApiKey,\r\n            useFloatingLabel,\r\n            formik: {\r\n                values: { shippingAddress: formAddress },\r\n            },\r\n            disabledFields\r\n        } = this.props;\r\n\r\n        const hasAddresses = addresses && addresses.length > 0;\r\n        const hasValidCustomerAddress = isValidCustomerAddress(\r\n            shippingAddress,\r\n            addresses,\r\n            formFields,\r\n        );\r\n\r\n        return (\r\n            <Fieldset id=\"checkoutShippingAddress\">\r\n                {hasAddresses && (\r\n                    <Fieldset id=\"shippingAddresses\">\r\n                        <LoadingOverlay isLoading={isLoading}>\r\n                            <AddressSelect\r\n                                addresses={addresses}\r\n                                onSelectAddress={onAddressSelect}\r\n                                onUseNewAddress={onUseNewAddress}\r\n                                selectedAddress={\r\n                                    hasValidCustomerAddress ? shippingAddress : undefined\r\n                                }\r\n                            />\r\n                        </LoadingOverlay>\r\n                    </Fieldset>\r\n                )}\r\n\r\n                {!hasValidCustomerAddress && (\r\n                    <LoadingOverlay isLoading={isLoading} unmountContentWhenLoading>\r\n                        <AddressForm\r\n                            countries={countries}\r\n                            countriesWithAutocomplete={countriesWithAutocomplete}\r\n                            countryCode={formAddress && formAddress.countryCode}\r\n                            disabledFields={disabledFields}\r\n                            fieldName={addressFieldName}\r\n                            formFields={formFields}\r\n                            googleMapsApiKey={googleMapsApiKey}\r\n                            onAutocompleteToggle={this.handleAutocompleteToggle}\r\n                            onChange={this.handleChange}\r\n                            setFieldValue={this.setFieldValue}\r\n                            shouldShowSaveAddress={shouldShowSaveAddress}\r\n                            useFloatingLabel={useFloatingLabel}\r\n                        />\r\n                    </LoadingOverlay>\r\n                )}\r\n            </Fieldset>\r\n        );\r\n    }\r\n\r\n    private setFieldValue: (fieldName: string, fieldValue: string) => void = (\r\n        fieldName,\r\n        fieldValue,\r\n    ) => {\r\n        const {\r\n            formik: { setFieldValue },\r\n            formFields,\r\n        } = this.props;\r\n\r\n        const customFormFieldNames = formFields\r\n            .filter((field) => field.custom)\r\n            .map((field) => field.name);\r\n\r\n        const formFieldName = customFormFieldNames.includes(fieldName)\r\n            ? `customFields.${fieldName}`\r\n            : fieldName;\r\n\r\n        setFieldValue(`${addressFieldName}.${formFieldName}`, fieldValue);\r\n    };\r\n\r\n    private handleChange: (fieldName: string, value: string) => void = (fieldName, value) => {\r\n        const { onFieldChange } = this.props;\r\n\r\n        onFieldChange(fieldName, value);\r\n    };\r\n\r\n    private handleAutocompleteToggle: (state: { inputValue: string; isOpen: boolean }) => void = ({\r\n        isOpen,\r\n        inputValue,\r\n    }) => {\r\n        const { onFieldChange } = this.props;\r\n\r\n        if (!isOpen) {\r\n            onFieldChange('address1', inputValue);\r\n        }\r\n    };\r\n}\r\n\r\nexport default connectFormik(ShippingAddressForm);\r\n","import {\r\n    Address,\r\n    CheckoutSelectors,\r\n    FormField,\r\n    ShippingInitializeOptions,\r\n    ShippingRequestOptions,\r\n} from '@bigcommerce/checkout-sdk';\r\nimport { noop } from 'lodash';\r\nimport React, { PureComponent, ReactNode } from 'react';\r\n\r\nimport { StaticAddress } from '../address/';\r\nimport { preventDefault } from '../common/dom';\r\nimport { TranslatedString } from '../locale';\r\nimport { Button, ButtonSize, ButtonVariant } from '../ui/button';\r\nimport { DynamicFormField, Fieldset } from '../ui/form';\r\nimport { LoadingOverlay } from '../ui/loading';\r\n\r\nimport './StaticAddressEditable.scss';\r\n\r\nexport interface StaticAddressEditableProps {\r\n    address: Address;\r\n    buttonId: string;\r\n    formFields: FormField[];\r\n    isLoading: boolean;\r\n    methodId?: string;\r\n    deinitialize(options?: ShippingRequestOptions): Promise<CheckoutSelectors>;\r\n    initialize(options?: ShippingInitializeOptions): Promise<CheckoutSelectors>;\r\n    onFieldChange(fieldName: string, value: string): void;\r\n    onUnhandledError?(error: Error): void;\r\n}\r\n\r\nclass StaticAddressEditable extends PureComponent<StaticAddressEditableProps> {\r\n    async componentDidMount(): Promise<void> {\r\n        const { initialize, methodId, onUnhandledError = noop } = this.props;\r\n\r\n        try {\r\n            await initialize({ methodId });\r\n        } catch (error) {\r\n            onUnhandledError(error);\r\n        }\r\n    }\r\n\r\n    async componentWillUnmount(): Promise<void> {\r\n        const { deinitialize, methodId, onUnhandledError = noop } = this.props;\r\n\r\n        try {\r\n            await deinitialize({ methodId });\r\n        } catch (error) {\r\n            onUnhandledError(error);\r\n        }\r\n    }\r\n\r\n    render(): ReactNode {\r\n        const { address, buttonId, formFields, isLoading } = this.props;\r\n\r\n        const customFormFields = formFields.filter(({ custom }) => custom);\r\n        const shouldShowCustomFormFields = customFormFields.length > 0;\r\n\r\n        return (\r\n            <LoadingOverlay isLoading={isLoading}>\r\n                <div className=\"stepHeader\" style={{ padding: 0 }}>\r\n                    <div className=\"stepHeader-body subheader\">\r\n                        <StaticAddress address={address} />\r\n                    </div>\r\n\r\n                    <div className=\"stepHeader-actions subheader\">\r\n                        <Button\r\n                            id={buttonId}\r\n                            onClick={preventDefault()}\r\n                            size={ButtonSize.Tiny}\r\n                            testId=\"step-edit-button\"\r\n                            variant={ButtonVariant.Secondary}\r\n                        >\r\n                            <TranslatedString id=\"common.edit_action\" />\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n\r\n                {shouldShowCustomFormFields && (\r\n                    <Fieldset id=\"customFieldset\">\r\n                        {customFormFields.map((field) => (\r\n                            <DynamicFormField\r\n                                field={field}\r\n                                key={`${field.id}-${field.name}`}\r\n                                onChange={this.handleFieldValueChange(field.name)}\r\n                                parentFieldName=\"shippingAddress.customFields\"\r\n                            />\r\n                        ))}\r\n                    </Fieldset>\r\n                )}\r\n            </LoadingOverlay>\r\n        );\r\n    }\r\n\r\n    private handleFieldValueChange: (name: string) => (value: string) => void =\r\n        (name) => (value) => {\r\n            const { onFieldChange } = this.props;\r\n\r\n            onFieldChange(name, value);\r\n        };\r\n}\r\n\r\nexport default StaticAddressEditable;\r\n","import {\r\n    Address,\r\n    CheckoutSelectors,\r\n    Consignment,\r\n    Country,\r\n    CustomerAddress,\r\n    FormField,\r\n    ShippingInitializeOptions,\r\n    ShippingRequestOptions,\r\n} from '@bigcommerce/checkout-sdk';\r\nimport { memoizeOne } from '@bigcommerce/memoize';\r\nimport { noop } from 'lodash';\r\nimport React, { FunctionComponent, memo, useCallback, useContext } from 'react';\r\n\r\nimport { FormContext } from '../ui/form';\r\n\r\nimport RemoteShippingAddress from './RemoteShippingAddress';\r\nimport ShippingAddressForm from './ShippingAddressForm';\r\nimport StaticAddressEditable from './StaticAddressEditable';\r\n\r\nexport interface ShippingAddressProps {\r\n    addresses: CustomerAddress[];\r\n    consignments: Consignment[];\r\n    countries?: Country[];\r\n    countriesWithAutocomplete: string[];\r\n    formFields: FormField[];\r\n    googleMapsApiKey?: string;\r\n    isLoading: boolean;\r\n    isShippingStepPending: boolean;\r\n    methodId?: string;\r\n    shippingAddress?: Address;\r\n    shouldShowSaveAddress?: boolean;\r\n    hasRequestedShippingOptions: boolean;\r\n    useFloatingLabel?: boolean;\r\n    deinitialize(options: ShippingRequestOptions): Promise<CheckoutSelectors>;\r\n    initialize(options: ShippingInitializeOptions): Promise<CheckoutSelectors>;\r\n    onAddressSelect(address: Address): void;\r\n    onFieldChange(name: string, value: string): void;\r\n    onUnhandledError?(error: Error): void;\r\n    onUseNewAddress(): void;\r\n    disabledFields?: boolean;\r\n}\r\n\r\nconst ShippingAddress: FunctionComponent<ShippingAddressProps> = (props) => {\r\n    const {\r\n        methodId,\r\n        formFields,\r\n        countries,\r\n        countriesWithAutocomplete,\r\n        consignments,\r\n        googleMapsApiKey,\r\n        onAddressSelect,\r\n        onFieldChange,\r\n        onUseNewAddress,\r\n        initialize,\r\n        deinitialize,\r\n        isLoading,\r\n        shippingAddress,\r\n        hasRequestedShippingOptions,\r\n        addresses,\r\n        shouldShowSaveAddress,\r\n        onUnhandledError = noop,\r\n        isShippingStepPending,\r\n        useFloatingLabel,\r\n        disabledFields\r\n    } = props;\r\n\r\n    const { setSubmitted } = useContext(FormContext);\r\n\r\n    const initializeShipping = useCallback(\r\n        memoizeOne(\r\n            (defaultOptions: ShippingInitializeOptions) => (options?: ShippingInitializeOptions) =>\r\n                initialize({\r\n                    ...defaultOptions,\r\n                    ...options,\r\n                }),\r\n        ),\r\n        [],\r\n    );\r\n\r\n    const handleFieldChange: (fieldName: string, value: string) => void = (fieldName, value) => {\r\n        if (hasRequestedShippingOptions) {\r\n            setSubmitted(true);\r\n        }\r\n\r\n        onFieldChange(fieldName, value);\r\n    };\r\n\r\n    if (methodId) {\r\n        const containerId = 'addressWidget';\r\n        let options: ShippingInitializeOptions = {};\r\n\r\n        if (methodId === 'amazon') {\r\n            options = {\r\n                amazon: {\r\n                    container: containerId,\r\n                    onError: onUnhandledError,\r\n                },\r\n            };\r\n\r\n            return (\r\n                <RemoteShippingAddress\r\n                    containerId={containerId}\r\n                    deinitialize={deinitialize}\r\n                    formFields={formFields}\r\n                    initialize={initializeShipping(options)}\r\n                    methodId={methodId}\r\n                    onFieldChange={onFieldChange}\r\n                    useFloatingLabel={useFloatingLabel}\r\n                />\r\n            );\r\n        }\r\n\r\n        if (methodId === 'amazonpay' && shippingAddress) {\r\n            const editAddressButtonId = 'edit-ship-button';\r\n\r\n            options = {\r\n                amazonpay: {\r\n                    editAddressButtonId,\r\n                },\r\n            };\r\n\r\n            return (\r\n                <StaticAddressEditable\r\n                    address={shippingAddress}\r\n                    buttonId={editAddressButtonId}\r\n                    deinitialize={deinitialize}\r\n                    formFields={formFields}\r\n                    initialize={initializeShipping(options)}\r\n                    isLoading={isShippingStepPending}\r\n                    methodId={methodId}\r\n                    onFieldChange={onFieldChange}\r\n                />\r\n            );\r\n        }\r\n    }\r\n\r\n    return (\r\n        <ShippingAddressForm\r\n            address={shippingAddress}\r\n            addresses={addresses}\r\n            consignments={consignments}\r\n            countries={countries}\r\n            countriesWithAutocomplete={countriesWithAutocomplete}\r\n            disabledFields={disabledFields}\r\n            formFields={formFields}\r\n            googleMapsApiKey={googleMapsApiKey}\r\n            isLoading={isLoading}\r\n            onAddressSelect={onAddressSelect}\r\n            onFieldChange={handleFieldChange}\r\n            onUseNewAddress={onUseNewAddress}\r\n            shouldShowSaveAddress={shouldShowSaveAddress}\r\n            useFloatingLabel={useFloatingLabel}\r\n        />\r\n    );\r\n};\r\n\r\nexport default memo(ShippingAddress);\r\n","export const SHIPPING_ADDRESS_FIELDS = [\r\n    'address1',\r\n    'postalCode',\r\n    'countryCode',\r\n    'city',\r\n    'stateOrProvince',\r\n    'stateOrProvinceCode',\r\n];\r\n","import {\r\n    Address,\r\n    CheckoutParams,\r\n    CheckoutSelectors,\r\n    Consignment,\r\n    Country,\r\n    CustomerAddress,\r\n    CustomerRequestOptions,\r\n    FormField,\r\n    RequestOptions,\r\n    ShippingInitializeOptions,\r\n    ShippingRequestOptions,\r\n} from '@bigcommerce/checkout-sdk';\r\nimport { FormikProps, withFormik } from 'formik';\r\nimport { debounce, noop } from 'lodash';\r\nimport React, { PureComponent, ReactNode } from 'react';\r\nimport { lazy, object } from 'yup';\r\n\r\nimport {\r\n    AddressFormValues,\r\n    getAddressFormFieldsValidationSchema,\r\n    getTranslateAddressError,\r\n    isEqualAddress,\r\n    mapAddressFromFormValues,\r\n    mapAddressToFormValues,\r\n} from '../address';\r\nimport { getCustomFormFieldsValidationSchema } from '../formFields';\r\nimport { withLanguage, WithLanguageProps } from '../locale';\r\nimport { Fieldset, Form, FormContext } from '../ui/form';\r\n\r\nimport BillingSameAsShippingField from './BillingSameAsShippingField';\r\nimport hasSelectedShippingOptions from './hasSelectedShippingOptions';\r\nimport ShippingAddress from './ShippingAddress';\r\nimport { SHIPPING_ADDRESS_FIELDS } from './ShippingAddressFields';\r\nimport ShippingFormFooter from './ShippingFormFooter';\r\n\r\nexport interface SingleShippingFormProps {\r\n    addresses: CustomerAddress[];\r\n    isBillingSameAsShipping: boolean;\r\n    cartHasChanged: boolean;\r\n    consignments: Consignment[];\r\n    countries: Country[];\r\n    countriesWithAutocomplete: string[];\r\n    customerMessage: string;\r\n    googleMapsApiKey?: string;\r\n    isLoading: boolean;\r\n    isShippingStepPending: boolean;\r\n    isMultiShippingMode: boolean;\r\n    methodId?: string;\r\n    shippingAddress?: Address;\r\n    shouldShowSaveAddress?: boolean;\r\n    shouldShowOrderComments: boolean;\r\n    useFloatingLabel?: boolean;\r\n    deinitialize(options: ShippingRequestOptions): Promise<CheckoutSelectors>;\r\n    deleteConsignments(): Promise<Address | undefined>;\r\n    getFields(countryCode?: string): FormField[];\r\n    initialize(options: ShippingInitializeOptions): Promise<CheckoutSelectors>;\r\n    onSubmit(values: SingleShippingFormValues): void;\r\n    onUnhandledError?(error: Error): void;\r\n    signOut(options?: CustomerRequestOptions): void;\r\n    updateAddress(\r\n        address: Partial<Address>,\r\n        options?: RequestOptions<CheckoutParams>,\r\n    ): Promise<CheckoutSelectors>;\r\n}\r\n\r\nexport interface SingleShippingFormValues {\r\n    billingSameAsShipping: boolean;\r\n    shippingAddress?: AddressFormValues;\r\n    orderComment: string;\r\n}\r\n\r\ninterface SingleShippingFormState {\r\n    isResettingAddress: boolean;\r\n    isUpdatingShippingData: boolean;\r\n    hasRequestedShippingOptions: boolean;\r\n}\r\n\r\nexport const SHIPPING_AUTOSAVE_DELAY = 1700;\r\n\r\nclass SingleShippingForm extends PureComponent<\r\n    SingleShippingFormProps & WithLanguageProps & FormikProps<SingleShippingFormValues>\r\n> {\r\n    static contextType = FormContext;\r\n\r\n    state: SingleShippingFormState = {\r\n        isResettingAddress: false,\r\n        isUpdatingShippingData: false,\r\n        hasRequestedShippingOptions: false,\r\n    };\r\n\r\n    private debouncedUpdateAddress: any;\r\n\r\n    constructor(\r\n        props: SingleShippingFormProps & WithLanguageProps & FormikProps<SingleShippingFormValues>,\r\n    ) {\r\n        super(props);\r\n\r\n        const { updateAddress } = this.props;\r\n\r\n        this.debouncedUpdateAddress = debounce(\r\n            async (address: Address, includeShippingOptions: boolean) => {\r\n                try {\r\n                    await updateAddress(address, {\r\n                        params: {\r\n                            include: {\r\n                                'consignments.availableShippingOptions': includeShippingOptions,\r\n                            },\r\n                        },\r\n                    });\r\n\r\n                    if (includeShippingOptions) {\r\n                        this.setState({ hasRequestedShippingOptions: true });\r\n                    }\r\n                } finally {\r\n                    this.setState({ isUpdatingShippingData: false });\r\n                }\r\n            },\r\n            SHIPPING_AUTOSAVE_DELAY,\r\n        );\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        if(window.location.search.length > 0){\r\n            const urlParams: any = new URLSearchParams(window.location.search);\r\n    \r\n            const shippingAddress: any = {\r\n                firstName: urlParams.get('first_name') || '',\r\n                lastName: urlParams.get('last_name') || '',\r\n                company: '',\r\n                address1: urlParams.get('address') || '',\r\n                address2: '',\r\n                city: urlParams.get('city') || '',\r\n                stateOrProvince: '',\r\n                stateOrProvinceCode: urlParams.get('state') || '',\r\n                country: '',\r\n                countryCode: urlParams.get('country') || '',\r\n                postalCode: urlParams.get('zipcode') || '',\r\n                phone: '',\r\n                customFields: []\r\n            }\r\n\r\n            this.props.setValues({\r\n                billingSameAsShipping: true,\r\n                orderComment: '',\r\n                shippingAddress,\r\n            });\r\n        }\r\n    }\r\n\r\n    render(): ReactNode {\r\n        const {\r\n            addresses,\r\n            cartHasChanged,\r\n            isLoading,\r\n            onUnhandledError,\r\n            methodId,\r\n            shouldShowSaveAddress,\r\n            countries,\r\n            countriesWithAutocomplete,\r\n            googleMapsApiKey,\r\n            shippingAddress,\r\n            consignments,\r\n            shouldShowOrderComments,\r\n            initialize,\r\n            isValid,\r\n            deinitialize,\r\n            values: { shippingAddress: addressForm },\r\n            isShippingStepPending,\r\n            useFloatingLabel,\r\n        } = this.props;\r\n\r\n        const { isResettingAddress, isUpdatingShippingData, hasRequestedShippingOptions } =\r\n            this.state;\r\n\r\n        const PAYMENT_METHOD_VALID = ['amazon', 'amazonpay'];\r\n        const shouldShowBillingSameAsShipping = !PAYMENT_METHOD_VALID.some(\r\n            (method) => method === methodId,\r\n        );\r\n\r\n        return (\r\n            <Form autoComplete=\"on\">\r\n                <Fieldset>\r\n                    <ShippingAddress\r\n                        addresses={addresses}\r\n                        consignments={consignments}\r\n                        countries={countries}\r\n                        countriesWithAutocomplete={countriesWithAutocomplete}\r\n                        deinitialize={deinitialize}\r\n                        disabledFields={true}\r\n                        formFields={this.getFields(addressForm && addressForm.countryCode)}\r\n                        googleMapsApiKey={googleMapsApiKey}\r\n                        hasRequestedShippingOptions={hasRequestedShippingOptions}\r\n                        initialize={initialize}\r\n                        isLoading={isResettingAddress}\r\n                        isShippingStepPending={isShippingStepPending}\r\n                        methodId={methodId}\r\n                        onAddressSelect={this.handleAddressSelect}\r\n                        onFieldChange={this.handleFieldChange}\r\n                        onUnhandledError={onUnhandledError}\r\n                        onUseNewAddress={this.onUseNewAddress}\r\n                        shippingAddress={shippingAddress}\r\n                        shouldShowSaveAddress={shouldShowSaveAddress}\r\n                        useFloatingLabel={useFloatingLabel}\r\n                    />\r\n                    {shouldShowBillingSameAsShipping && (\r\n                        <div className=\"form-body\">\r\n                            <BillingSameAsShippingField />\r\n                        </div>\r\n                    )}\r\n                </Fieldset>\r\n\r\n                <ShippingFormFooter\r\n                    cartHasChanged={cartHasChanged}\r\n                    isLoading={isLoading || isUpdatingShippingData}\r\n                    isMultiShippingMode={false}\r\n                    shouldDisableSubmit={this.shouldDisableSubmit()}\r\n                    shouldShowOrderComments={shouldShowOrderComments}\r\n                    shouldShowShippingOptions={isValid}\r\n                />\r\n            </Form>\r\n        );\r\n    }\r\n\r\n    private shouldDisableSubmit: () => boolean = () => {\r\n        const { isLoading, consignments, isValid } = this.props;\r\n\r\n        const { isUpdatingShippingData } = this.state;\r\n\r\n        if (!isValid) {\r\n            return false;\r\n        }\r\n\r\n        return isLoading || isUpdatingShippingData || !hasSelectedShippingOptions(consignments);\r\n    };\r\n\r\n    private handleFieldChange: (name: string) => void = async (name) => {\r\n        const { setFieldValue } = this.props;\r\n\r\n        if (name === 'countryCode') {\r\n            setFieldValue('shippingAddress.stateOrProvince', '');\r\n            setFieldValue('shippingAddress.stateOrProvinceCode', '');\r\n        }\r\n\r\n        // Enqueue the following code to run after Formik has run validation\r\n        await new Promise((resolve) => setTimeout(resolve));\r\n\r\n        const isShippingField = SHIPPING_ADDRESS_FIELDS.includes(name);\r\n\r\n        const { hasRequestedShippingOptions } = this.state;\r\n\r\n        const { isValid } = this.props;\r\n\r\n        if (!isValid) {\r\n            return;\r\n        }\r\n\r\n        this.updateAddressWithFormData(isShippingField || !hasRequestedShippingOptions);\r\n    };\r\n\r\n    private updateAddressWithFormData(includeShippingOptions: boolean) {\r\n        const {\r\n            shippingAddress,\r\n            values: { shippingAddress: addressForm },\r\n        } = this.props;\r\n\r\n        const updatedShippingAddress = addressForm && mapAddressFromFormValues(addressForm);\r\n\r\n        if (!updatedShippingAddress || isEqualAddress(updatedShippingAddress, shippingAddress)) {\r\n            return;\r\n        }\r\n\r\n        this.setState({ isUpdatingShippingData: true });\r\n        this.debouncedUpdateAddress(updatedShippingAddress, includeShippingOptions);\r\n    }\r\n\r\n    private handleAddressSelect: (address: Address) => void = async (address) => {\r\n        const { updateAddress, onUnhandledError = noop, values, setValues } = this.props;\r\n\r\n        this.setState({ isResettingAddress: true });\r\n\r\n        try {\r\n            await updateAddress(address);\r\n\r\n            setValues({\r\n                ...values,\r\n                shippingAddress: mapAddressToFormValues(\r\n                    this.getFields(address.countryCode),\r\n                    address,\r\n                ),\r\n            });\r\n        } catch (error) {\r\n            onUnhandledError(error);\r\n        } finally {\r\n            this.setState({ isResettingAddress: false });\r\n        }\r\n    };\r\n\r\n    private onUseNewAddress: () => void = async () => {\r\n        const { deleteConsignments, onUnhandledError = noop, setValues, values } = this.props;\r\n\r\n        this.setState({ isResettingAddress: true });\r\n\r\n        try {\r\n            const address = await deleteConsignments();\r\n\r\n            setValues({\r\n                ...values,\r\n                shippingAddress: mapAddressToFormValues(\r\n                    this.getFields(address && address.countryCode),\r\n                    address,\r\n                ),\r\n            });\r\n        } catch (e) {\r\n            onUnhandledError(e);\r\n        } finally {\r\n            this.setState({ isResettingAddress: false });\r\n        }\r\n    };\r\n\r\n    private getFields(countryCode: string | undefined): FormField[] {\r\n        const { getFields } = this.props;\r\n\r\n        return getFields(countryCode);\r\n    }\r\n}\r\n\r\nexport default withLanguage(\r\n    withFormik<SingleShippingFormProps & WithLanguageProps, SingleShippingFormValues>({\r\n        handleSubmit: (values, { props: { onSubmit } }) => {\r\n            onSubmit(values);\r\n        },\r\n        mapPropsToValues: ({\r\n            getFields,\r\n            shippingAddress,\r\n            isBillingSameAsShipping,\r\n            customerMessage,\r\n        }) => ({\r\n            billingSameAsShipping: isBillingSameAsShipping,\r\n            orderComment: customerMessage,\r\n            shippingAddress: mapAddressToFormValues(\r\n                getFields(shippingAddress && shippingAddress.countryCode),\r\n                shippingAddress,\r\n            ),\r\n        }),\r\n        isInitialValid: ({ shippingAddress, getFields, language }) =>\r\n            !!shippingAddress &&\r\n            getAddressFormFieldsValidationSchema({\r\n                language,\r\n                formFields: getFields(shippingAddress.countryCode),\r\n            }).isValidSync(shippingAddress),\r\n        validationSchema: ({\r\n            language,\r\n            getFields,\r\n            methodId,\r\n        }: SingleShippingFormProps & WithLanguageProps) =>\r\n            methodId\r\n                ? object({\r\n                      shippingAddress: lazy<Partial<AddressFormValues>>((formValues) =>\r\n                          getCustomFormFieldsValidationSchema({\r\n                              translate: getTranslateAddressError(language),\r\n                              formFields: getFields(formValues && formValues.countryCode),\r\n                          }),\r\n                      ),\r\n                  })\r\n                : object({\r\n                      shippingAddress: lazy<Partial<AddressFormValues>>((formValues) =>\r\n                          getAddressFormFieldsValidationSchema({\r\n                              language,\r\n                              formFields: getFields(formValues && formValues.countryCode),\r\n                          }),\r\n                      ),\r\n                  }),\r\n        enableReinitialize: false,\r\n    })(SingleShippingForm),\r\n);\r\n","import {\r\n    Address,\r\n    AddressRequestBody,\r\n    Cart,\r\n    CheckoutParams,\r\n    CheckoutSelectors,\r\n    Consignment,\r\n    ConsignmentAssignmentRequestBody,\r\n    Country,\r\n    CustomerAddress,\r\n    CustomerRequestOptions,\r\n    FormField,\r\n    RequestOptions,\r\n    ShippingInitializeOptions,\r\n    ShippingRequestOptions,\r\n} from '@bigcommerce/checkout-sdk';\r\nimport React, { Component, ReactNode } from 'react';\r\n\r\nimport { withLanguage, WithLanguageProps } from '../locale';\r\n\r\nimport MultiShippingForm, { MultiShippingFormValues } from './MultiShippingForm';\r\nimport SingleShippingForm, { SingleShippingFormValues } from './SingleShippingForm';\r\n\r\nexport interface ShippingFormProps {\r\n    addresses: CustomerAddress[];\r\n    cart: Cart;\r\n    cartHasChanged: boolean;\r\n    consignments: Consignment[];\r\n    countries: Country[];\r\n    countriesWithAutocomplete: string[];\r\n    customerMessage: string;\r\n    googleMapsApiKey?: string;\r\n    isBillingSameAsShipping: boolean;\r\n    isGuest: boolean;\r\n    isLoading: boolean;\r\n    isShippingStepPending: boolean;\r\n    isMultiShippingMode: boolean;\r\n    methodId?: string;\r\n    shippingAddress?: Address;\r\n    shouldShowSaveAddress?: boolean;\r\n    shouldShowOrderComments: boolean;\r\n    shouldShowAddAddressInCheckout: boolean;\r\n    useFloatingLabel?: boolean;\r\n    assignItem(consignment: ConsignmentAssignmentRequestBody): Promise<CheckoutSelectors>;\r\n    deinitialize(options: ShippingRequestOptions): Promise<CheckoutSelectors>;\r\n    deleteConsignments(): Promise<Address | undefined>;\r\n    getFields(countryCode?: string): FormField[];\r\n    initialize(options: ShippingInitializeOptions): Promise<CheckoutSelectors>;\r\n    onCreateAccount(): void;\r\n    createCustomerAddress(address: AddressRequestBody): Promise<CheckoutSelectors>;\r\n    onMultiShippingSubmit(values: MultiShippingFormValues): void;\r\n    onSignIn(): void;\r\n    onSingleShippingSubmit(values: SingleShippingFormValues): void;\r\n    onUnhandledError(error: Error): void;\r\n    onUseNewAddress(address: Address, itemId: string): void;\r\n    signOut(options?: CustomerRequestOptions): void;\r\n    updateAddress(\r\n        address: Partial<Address>,\r\n        options: RequestOptions<CheckoutParams>,\r\n    ): Promise<CheckoutSelectors>;\r\n}\r\n\r\nclass ShippingForm extends Component<ShippingFormProps & WithLanguageProps> {\r\n    render(): ReactNode {\r\n        const {\r\n            addresses,\r\n            assignItem,\r\n            cart,\r\n            cartHasChanged,\r\n            createCustomerAddress,\r\n            consignments,\r\n            countries,\r\n            countriesWithAutocomplete,\r\n            onCreateAccount,\r\n            customerMessage,\r\n            deinitialize,\r\n            deleteConsignments,\r\n            getFields,\r\n            googleMapsApiKey,\r\n            initialize,\r\n            isBillingSameAsShipping,\r\n            isGuest,\r\n            isLoading,\r\n            isMultiShippingMode,\r\n            methodId,\r\n            onMultiShippingSubmit,\r\n            onSignIn,\r\n            onSingleShippingSubmit,\r\n            onUnhandledError,\r\n            onUseNewAddress,\r\n            shippingAddress,\r\n            shouldShowOrderComments,\r\n            shouldShowSaveAddress,\r\n            shouldShowAddAddressInCheckout,\r\n            signOut,\r\n            updateAddress,\r\n            isShippingStepPending,\r\n            useFloatingLabel,\r\n        } = this.props;\r\n\r\n        return isMultiShippingMode ? (\r\n            <MultiShippingForm\r\n                addresses={addresses}\r\n                assignItem={assignItem}\r\n                cart={cart}\r\n                cartHasChanged={cartHasChanged}\r\n                consignments={consignments}\r\n                countries={countries}\r\n                countriesWithAutocomplete={countriesWithAutocomplete}\r\n                createCustomerAddress={createCustomerAddress}\r\n                customerMessage={customerMessage}\r\n                defaultCountryCode={shippingAddress?.countryCode}\r\n                getFields={getFields}\r\n                googleMapsApiKey={googleMapsApiKey}\r\n                isGuest={isGuest}\r\n                isLoading={isLoading}\r\n                onCreateAccount={onCreateAccount}\r\n                onSignIn={onSignIn}\r\n                onSubmit={onMultiShippingSubmit}\r\n                onUnhandledError={onUnhandledError}\r\n                onUseNewAddress={onUseNewAddress}\r\n                shouldShowAddAddressInCheckout={shouldShowAddAddressInCheckout}\r\n                shouldShowOrderComments={shouldShowOrderComments}\r\n                useFloatingLabel={useFloatingLabel}\r\n            />\r\n        ) : (\r\n            <SingleShippingForm\r\n                addresses={addresses}\r\n                cartHasChanged={cartHasChanged}\r\n                consignments={consignments}\r\n                countries={countries}\r\n                countriesWithAutocomplete={countriesWithAutocomplete}\r\n                customerMessage={customerMessage}\r\n                deinitialize={deinitialize}\r\n                deleteConsignments={deleteConsignments}\r\n                getFields={getFields}\r\n                googleMapsApiKey={googleMapsApiKey}\r\n                initialize={initialize}\r\n                isBillingSameAsShipping={isBillingSameAsShipping}\r\n                isLoading={isLoading}\r\n                isMultiShippingMode={isMultiShippingMode}\r\n                isShippingStepPending={isShippingStepPending}\r\n                methodId={methodId}\r\n                onSubmit={onSingleShippingSubmit}\r\n                onUnhandledError={onUnhandledError}\r\n                shippingAddress={shippingAddress}\r\n                shouldShowOrderComments={shouldShowOrderComments}\r\n                shouldShowSaveAddress={shouldShowSaveAddress}\r\n                signOut={signOut}\r\n                updateAddress={updateAddress}\r\n                useFloatingLabel={useFloatingLabel}\r\n            />\r\n        );\r\n    }\r\n}\r\n\r\nexport default withLanguage(ShippingForm);\r\n","import React, { FunctionComponent, memo } from 'react';\r\n\r\nimport { preventDefault } from '../common/dom';\r\nimport { TranslatedString } from '../locale';\r\nimport { Legend } from '../ui/form';\r\n\r\ninterface ShippingHeaderProps {\r\n    isMultiShippingMode: boolean;\r\n    isGuest: boolean;\r\n    shouldShowMultiShipping: boolean;\r\n    onMultiShippingChange(): void;\r\n}\r\n\r\nconst ShippingHeader: FunctionComponent<ShippingHeaderProps> = ({\r\n    isMultiShippingMode,\r\n    isGuest,\r\n    onMultiShippingChange,\r\n    shouldShowMultiShipping,\r\n}) => (\r\n    <div className=\"form-legend-container\">\r\n        <Legend testId=\"shipping-address-heading\">\r\n            <TranslatedString\r\n                id={\r\n                    isMultiShippingMode\r\n                        ? isGuest\r\n                            ? 'shipping.multishipping_address_heading_guest'\r\n                            : 'shipping.multishipping_address_heading'\r\n                        : 'shipping.shipping_address_heading'\r\n                }\r\n            />\r\n        </Legend>\r\n\r\n        {shouldShowMultiShipping && (\r\n            <a\r\n                data-test=\"shipping-mode-toggle\"\r\n                href=\"#\"\r\n                onClick={preventDefault(onMultiShippingChange)}\r\n            >\r\n                <TranslatedString\r\n                    id={isMultiShippingMode ? 'shipping.ship_to_single' : 'shipping.ship_to_multi'}\r\n                />\r\n            </a>\r\n        )}\r\n    </div>\r\n);\r\n\r\nexport default memo(ShippingHeader);\r\n","import { CheckoutSelectors, ShippingInitializeOptions, ShippingRequestOptions } from '@bigcommerce/checkout-sdk';\r\nimport { noop } from 'lodash';\r\nimport React, { PureComponent, ReactNode } from 'react';\r\n\r\nexport interface StripeupeShippingAddressProps {\r\n    methodId?: string;\r\n    deinitialize(options?: ShippingRequestOptions): Promise<CheckoutSelectors>;\r\n    initialize(options?: ShippingInitializeOptions): Promise<CheckoutSelectors>;\r\n    onUnhandledError?(error: Error): void;\r\n}\r\n\r\nclass StripeShippingAddressDisplay extends PureComponent<StripeupeShippingAddressProps> {\r\n    async componentDidMount(): Promise<void> {\r\n        const {\r\n            initialize,\r\n            methodId,\r\n            onUnhandledError = noop,\r\n        } = this.props;\r\n\r\n        try {\r\n            await initialize({ methodId });\r\n        } catch (error) {\r\n            onUnhandledError(error);\r\n        }\r\n    }\r\n\r\n    async componentWillUnmount(): Promise<void> {\r\n        const {\r\n            deinitialize,\r\n            methodId,\r\n            onUnhandledError = noop,\r\n        } = this.props;\r\n\r\n        try {\r\n            await deinitialize({ methodId });\r\n        } catch (error) {\r\n            onUnhandledError(error);\r\n        }\r\n    }\r\n\r\n    render(): ReactNode {\r\n\r\n        return (\r\n            <>\r\n                <div className=\"stepHeader\" style={ { padding: 0 } }>\r\n                    <div id=\"StripeUpeShipping\" style={ { width: '100%' } } />\r\n                </div>\r\n                <br />\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default StripeShippingAddressDisplay;\r\n","interface StripeCountryMapping {\r\n    [key: string]: StripeStateMapping;\r\n}\r\n\r\ninterface StripeStateMapping {\r\n    [key: string]: string;\r\n}\r\n\r\nexport default function StripeStateMapper(country: string, state: string): string {\r\n\r\n    const countries: StripeCountryMapping = {\r\n        'MX': {\r\n            'Ags.': 'AGU',\r\n            'B.C.': 'BCN',\r\n            'B.C.S.': 'BCS',\r\n            'Camp.': 'CAM',\r\n            'Coah.': 'COA',\r\n            'Col.': 'COL',\r\n            'Chis.': 'CHP',\r\n            'Chih.': 'CHH',\r\n            'Dgo.': 'DUR',\r\n            'Gto.': 'GUA',\r\n            'Gro.': 'GRO',\r\n            'Hgo.': 'HID',\r\n            'Jal.': 'JAL',\r\n            'Méx.': 'MEX',\r\n            'CDMX': 'MEX',\r\n            'Mich.': 'MIC',\r\n            'Mor.': 'MOR',\r\n            'Nay.': 'NAY',\r\n            'N.L.': 'NLE',\r\n            'Oax.': 'OAX',\r\n            'Pue.': 'PUE',\r\n            'Qro.': 'QUE',\r\n            'Q.R.': 'ROO',\r\n            'S.L.P.': 'SLP',\r\n            'Sin.': 'SIN',\r\n            'Son.': 'SON',\r\n            'Tab.': 'TAB',\r\n            'Tamps.': 'TAM',\r\n            'Tlax.': 'TLA',\r\n            'Ver.': 'VER',\r\n            'Yuc.': 'YUC',\r\n            'Zac.': 'ZAC',\r\n        },\r\n        'AR': {\r\n            'Ciudad Autónoma de Buenos Aires': 'C',\r\n            'Buenos Aires': 'B',\r\n            'Catamarca': 'K',\r\n            'Chaco': 'H',\r\n            'Chubut': 'U',\r\n            'Córdoba': 'X',\r\n            'Corrientes': 'W',\r\n            'Entre Ríos': 'E',\r\n            'Formosa': 'P',\r\n            'Jujuy': 'Y',\r\n            'La Pampa': 'L',\r\n            'La Rioja': 'F',\r\n            'Mendoza': 'M',\r\n            'Misiones': 'N',\r\n            'Neuquén': 'Q',\r\n            'Salta': 'A',\r\n            'San Juan': 'J',\r\n            'San Luis': 'D',\r\n            'Santa Fe': 'S',\r\n            'Santiago del Estero': 'G',\r\n            'Tierra del Fuego': 'V',\r\n            'Tucumán': 'W',\r\n        },\r\n        'IN': {\r\n            'Andhra Pradesh': 'AP',\r\n            'Arunachal Pradesh': 'AR',\r\n            'Assam': 'AS',\r\n            'Bihar': 'BR',\r\n            'Chhattisgarh': 'CG',\r\n            'Goa': 'GA',\r\n            'Gujarat': 'GJ',\r\n            'Haryana': 'HR',\r\n            'Himachal Pradesh': 'HP',\r\n            'Jammu and Kashmir': 'JK',\r\n            'Jharkhand': 'JH',\r\n            'Karnataka': 'KA',\r\n            'Kerala': 'KL',\r\n            'Madhya Pradesh': 'MP',\r\n            'Maharashtra': 'MH',\r\n            'Manipur': 'MN',\r\n            'Meghalaya': 'ML',\r\n            'Mizoram': 'MZ',\r\n            'Nagaland': 'NL',\r\n            'Odisha': 'OR',\r\n            'Punjab': 'PB',\r\n            'Rajasthan': 'RJ',\r\n            'Sikkim': 'SK',\r\n            'Tamil Nadu': 'TN',\r\n            'Tripura': 'TR',\r\n            'Uttarakhand': 'UK',\r\n            'Uttar Pradesh': 'UP',\r\n            'West Bengal': 'WB',\r\n            'Andaman and Nicobar Islands': 'AN',\r\n            'Chandigarh': 'CH',\r\n            'Dadra and Nagar Haveli and Daman and Diu': 'DN',\r\n            'Lakshadweep': 'LD',\r\n            'Delhi': 'DL',\r\n            'Puducherry': 'PY',\r\n            'Telangana': 'TS',\r\n        },\r\n        'ID': {\r\n            'Bali': 'BA',\r\n            'Banten': 'BT',\r\n            'Bengkulu': 'BE',\r\n            'Aceh': 'DA',\r\n            'DKI Jakarta': 'JK',\r\n            'Sumatera Utara': 'SU',\r\n            'Sumatera Barat': 'SB',\r\n            'Riau': 'SI',\r\n            'Jambi': 'JA',\r\n            'Sumatera Selatan': 'SS',\r\n            'Lampung': 'LA',\r\n            'Jawa Barat': 'JB',\r\n            'Jawa Timur': 'JT',\r\n            'Daerah Istimewa Yogyakarta': 'DY',\r\n            'Kalimantan Barat': 'KB',\r\n            'Kalimantan Tengah': 'KT',\r\n            'Kalimantan Timur': 'KI',\r\n            'Kalimantan Selatan': 'KS',\r\n            'Nusa Tenggara Barat': 'NB',\r\n            'Nusa Tenggara Timur': 'NT',\r\n            'Sulawesi Selatan': 'SN',\r\n            'Sulawesi Tengah': 'ST',\r\n            'Sulawesi Utara': 'SA',\r\n            'Sulawesi Tenggara': 'SG',\r\n            'Maluku': 'MA',\r\n            'Maluku Utara': 'MU',\r\n            'Gorontalo': 'GO',\r\n        },\r\n        'MY': {\r\n            'Johor': 'JHR',\r\n            'Kedah': 'KDH',\r\n            'Kelantan': 'KTN',\r\n            'Melaka': 'MLK',\r\n            'Negeri Sembilan': 'NSN',\r\n            'Pahang': 'PHG',\r\n            'Pulau Pinang': 'PNG',\r\n            'Perak': 'PRK',\r\n            'Perlis': 'PLS',\r\n            'Selangor': 'SGR',\r\n            'Terengganu': 'TRG',\r\n            'Sabah': 'SBH',\r\n            'Sarawak': 'SRW',\r\n            'Kuala Lumpur': 'KUL',\r\n            'Labuan': 'LBN',\r\n            'Putrajaya': 'PJY',\r\n        },\r\n        'IE': {\r\n            'Carlow': 'CW',\r\n            'Cavan': 'CN',\r\n            'Clare': 'CE',\r\n            'Donegal': 'DL',\r\n            'Dublin': 'D',\r\n            'Galway': 'G',\r\n            'Kildare': 'KE',\r\n            'Kilkenny': 'KK',\r\n            'Laois': 'LS',\r\n            'Leitrim': 'LM',\r\n            'Longford': 'LD',\r\n            'Louth': 'LH',\r\n            'Mayo': 'MO',\r\n            'Meath': 'MH',\r\n            'Monaghan': 'MN',\r\n            'Offaly': 'OY',\r\n            'Roscommon': 'RN',\r\n            'Sligo': 'SO',\r\n            'Tipperary': 'TA',\r\n            'Waterford': 'WD',\r\n            'Westmeath': 'WH',\r\n            'Wexford': 'WX',\r\n            'Wicklow': 'WW',\r\n        },\r\n        'ES': {\r\n            'C': 'ACOR',\r\n            'VI': 'ALAV',\r\n            'AB': 'ALBA',\r\n            'A': 'ALIC',\r\n            'AL': 'ALME',\r\n            'O': 'ASTU',\r\n            'AV': 'AVIL',\r\n            'BA': 'BADA',\r\n            'PM': 'BALE',\r\n            'B': 'BARC',\r\n            'BU': 'BURG',\r\n            'CC': 'CACE',\r\n            'CA': 'CADI',\r\n            'S': 'CANT',\r\n            'CS': 'CAST',\r\n            'CE': 'CEUT',\r\n            'CR': 'CIUD',\r\n            'CO': 'CORD',\r\n            'CU': 'CUEN',\r\n            'GI': 'GIRO',\r\n            'GR': 'GRAN',\r\n            'GU': 'GUAD',\r\n            'SS': 'GUIP',\r\n            'H': 'HUEL',\r\n            'HU': 'HUES',\r\n            'J': 'JAEN',\r\n            'LO': 'LAR',\r\n            'GC': 'LAS',\r\n            'LE': 'LEON',\r\n            'L': 'LLEI',\r\n            'LU': 'LUGO',\r\n            'M': 'MADR',\r\n            'MA': 'MALA',\r\n            'ML': 'MELI',\r\n            'MU': 'MURC',\r\n            'NA': 'NAVA',\r\n            'OR': 'OURE',\r\n            'P': 'PALE',\r\n            'PO': 'PONT',\r\n            'SA': 'SALA',\r\n            'TF': 'SANT',\r\n            'SG': 'SEGO',\r\n            'SE': 'SEVI',\r\n            'SO': 'SORI',\r\n            'T': 'TARR',\r\n            'TE': 'TERU',\r\n            'TP': 'TOLE',\r\n            'V': 'VALE',\r\n            'VA': 'VALL',\r\n            'BI': 'VIZC',\r\n            'ZA': 'ZAMO',\r\n            'Z': 'ZARA',\r\n        }\r\n    };\r\n\r\n    if (countries[country]) {\r\n        return countries[country][state] ?? getStripeState(countries[country], state);\r\n    }\r\n\r\n    return state;\r\n}\r\n\r\nfunction getStripeState(stateList: StripeStateMapping, state: string) {\r\n    return Object.keys(stateList).find(key => stateList[key] === state) || state;\r\n}\r\n","import {\r\n    Address,\r\n    CheckoutSelectors,\r\n    Consignment,\r\n    Country,\r\n    ShippingInitializeOptions,\r\n    ShippingRequestOptions,\r\n    StripeShippingEvent\r\n} from '@bigcommerce/checkout-sdk';\r\nimport { memoizeOne } from '@bigcommerce/memoize';\r\nimport React, { FunctionComponent, memo, useCallback, useEffect, useState } from 'react';\r\n\r\nimport CheckoutStepStatus from '../../checkout/CheckoutStepStatus';\r\nimport { getAppliedStyles } from '../../common/dom';\r\nimport getRecommendedShippingOption from '../getRecommendedShippingOption';\r\nimport hasSelectedShippingOptions from '../hasSelectedShippingOptions';\r\nimport { SingleShippingFormValues } from '../SingleShippingForm';\r\n\r\nimport StripeShippingAddressDisplay from './StripeShippingAddressDisplay';\r\nimport StripeStateMapper from './StripeStateMapper';\r\n\r\nexport interface StripeShippingAddressProps {\r\n    consignments: Consignment[];\r\n    countries?: Country[];\r\n    shippingAddress?: Address;\r\n    step: CheckoutStepStatus;\r\n    isShippingMethodLoading: boolean;\r\n    shouldDisableSubmit: boolean;\r\n    isStripeLoading?(): void;\r\n    isStripeAutoStep?(): void;\r\n    deinitialize(options: ShippingRequestOptions): Promise<CheckoutSelectors>;\r\n    initialize(options: ShippingInitializeOptions): Promise<CheckoutSelectors>;\r\n    onAddressSelect(address: Address): void;\r\n    onSubmit(values: SingleShippingFormValues): void;\r\n}\r\n\r\nconst StripeShippingAddress: FunctionComponent<StripeShippingAddressProps> = (props) => {\r\n    const {\r\n        countries,\r\n        consignments,\r\n        onAddressSelect,\r\n        initialize,\r\n        deinitialize,\r\n        shouldDisableSubmit,\r\n        onSubmit,\r\n        step,\r\n        isStripeLoading,\r\n        isStripeAutoStep,\r\n        isShippingMethodLoading,\r\n        shippingAddress,\r\n    } = props;\r\n\r\n    const [isNewAddress, setIsNewAddress] = useState(true);\r\n    const [isFirstShippingRender, setIsFirstShippingRender] = useState(true);\r\n    const [stripeShippingAddress, setStripeShippingAddress] =  useState({\r\n        firstName: '',\r\n        lastName: '',\r\n        company: '',\r\n        address1: '',\r\n        address2: '',\r\n        city: '',\r\n        stateOrProvince: '',\r\n        stateOrProvinceCode: '',\r\n        shouldSaveAddress: true,\r\n        country: '',\r\n        countryCode: '',\r\n        postalCode: '',\r\n        phone: '',\r\n        customFields: [],\r\n    });\r\n\r\n    const handleLoading = useCallback(() => {\r\n        if (isStripeLoading) {\r\n            isStripeLoading();\r\n        }\r\n    }, [isStripeLoading]);\r\n\r\n    useEffect(() => {\r\n        if (consignments[0]) {\r\n            const {availableShippingOptions} = consignments[0];\r\n\r\n            if (availableShippingOptions && !getRecommendedShippingOption(availableShippingOptions)) {\r\n                handleLoading();\r\n            }\r\n        }\r\n    }, [consignments]);\r\n\r\n    useEffect(() => {\r\n        const hasStripeAddressAndHasShippingOptions = stripeShippingAddress.firstName && hasSelectedShippingOptions(consignments);\r\n        const afterReload = !isFirstShippingRender && !isNewAddress && !isShippingMethodLoading;\r\n        const isLoadingBeforeAutoStep =  isStripeLoading && isStripeAutoStep;\n\r\n        if (hasStripeAddressAndHasShippingOptions && afterReload && isLoadingBeforeAutoStep) {\r\n            isStripeLoading();\r\n            isStripeAutoStep();\r\n            onSubmit({billingSameAsShipping: true, shippingAddress: stripeShippingAddress, orderComment: ''});\r\n        }\r\n    }, [isFirstShippingRender, onSubmit, stripeShippingAddress, shouldDisableSubmit, isShippingMethodLoading, isNewAddress ,consignments]);\r\n\r\n    const availableShippingList = countries?.map(country => ({code: country.code, name: country.name}));\r\n    const allowedCountries = availableShippingList ? availableShippingList.map(country => country.code).join(', ') : '';\r\n\r\n    const handleStripeShippingAddress = useCallback(async (shipping: StripeShippingEvent) => {\r\n        const {complete, value: { address = { country: '', state: '', line1: '', line2: '', city: '', postal_code: '' }\r\n            , name = '' } } = shipping;\r\n\r\n        if(complete) {\r\n            if (step.isComplete || (shippingAddress?.firstName && shipping.isNewAddress)) {\r\n                handleLoading();\r\n            }\r\n\r\n            const names = name.split(' ');\r\n            // @ts-ignore\r\n            const country = availableShippingList?.find(country => country.code === address.country).name;\r\n            const state = StripeStateMapper(address.country, address.state);\r\n            const shippingValue = {\r\n                firstName: names[0],\r\n                lastName: names[1] || ' ',\r\n                company: '',\r\n                address1: address.line1,\r\n                address2: address.line2 || '',\r\n                city: address.city,\r\n                stateOrProvince: state,\r\n                stateOrProvinceCode: state,\r\n                shouldSaveAddress: true,\r\n                country: country || address.country,\r\n                countryCode: address.country,\r\n                postalCode: address.postal_code,\r\n                phone: '',\r\n                customFields: [],\r\n            };\r\n\r\n            if (!step.isComplete) {\r\n                setIsFirstShippingRender(current => !current);\r\n            }\r\n\r\n            onAddressSelect(shippingValue);\r\n            setStripeShippingAddress(shippingValue);\r\n\r\n            if (shipping.isNewAddress !== isNewAddress) {\r\n                setIsNewAddress(current => !current);\r\n            }\r\n        } else {\r\n            handleLoading();\r\n        }\r\n\r\n    }, [availableShippingList, onAddressSelect]);\r\n\r\n    const initializeShipping = useCallback(\r\n        memoizeOne(\r\n            (defaultOptions: ShippingInitializeOptions) => (options?: ShippingInitializeOptions) =>\r\n                initialize({\r\n                    ...defaultOptions,\r\n                    ...options,\r\n                }),\r\n        ),\r\n        [],\r\n    );\r\n\r\n    const getStylesFromElement = (\r\n        id: string,\r\n        properties: string[]) => {\r\n        const parentContainer = document.getElementById(id);\r\n\r\n        if (parentContainer) {\r\n            return getAppliedStyles(parentContainer, properties);\r\n        }\r\n\r\n        return undefined;\r\n    };\r\n\r\n    const getStripeStyles: any = useCallback( () => {\r\n        const containerId = 'stripe-card-component-field';\r\n        const formInput = getStylesFromElement(`${containerId}--input`, ['color', 'background-color', 'border-color', 'box-shadow']);\r\n        const formLabel = getStylesFromElement(`${containerId}--label`, ['color']);\r\n        const formError = getStylesFromElement(`${containerId}--error`, ['color']);\r\n\r\n        return formLabel && formInput && formError ? {\r\n            labelText: formLabel.color,\r\n            fieldText: formInput.color,\r\n            fieldPlaceholderText: formInput.color,\r\n            fieldErrorText: formError.color,\r\n            fieldBackground: formInput['background-color'],\r\n            fieldInnerShadow: formInput['box-shadow'],\r\n            fieldBorder: formInput['border-color'],\r\n        } : undefined;\r\n    }, [])\r\n\r\n        const options: ShippingInitializeOptions = {\r\n            stripeupe: {\r\n                container: 'StripeUpeShipping',\r\n                onChangeShipping: handleStripeShippingAddress,\r\n                availableCountries: allowedCountries,\r\n                getStyles: getStripeStyles,\r\n                getStripeState: StripeStateMapper,\r\n                gatewayId: 'stripeupe',\r\n                methodId: 'card',\r\n            },\r\n        };\r\n\r\n        const renderCheckoutThemeStylesForStripeUPE = () => {\r\n            const containerId = 'stripe-card-component-field';\r\n\r\n            return (\r\n                <div\r\n                    className=\"optimizedCheckout-form-input\"\r\n                    id={ `${containerId}--input` }\r\n                    placeholder=\"1111\"\r\n                >\r\n                    <div\r\n                        className=\"form-field--error\"\r\n                    >\r\n                        <div\r\n                            className=\"optimizedCheckout-form-label\"\r\n                            id={ `${containerId}--error` }\r\n                        />\r\n                    </div>\r\n                    <div\r\n                        className=\"optimizedCheckout-form-label\"\r\n                        id={ `${containerId}--label` }\r\n                    />\r\n                </div>\r\n            );\r\n        };\r\n\r\n        return (\r\n            <>\r\n                <StripeShippingAddressDisplay\r\n                    deinitialize={ deinitialize }\r\n                    initialize={ initializeShipping(options) }\r\n                    methodId=\"stripeupe\"\r\n                />\r\n                { renderCheckoutThemeStylesForStripeUPE() }\r\n            </>\r\n        );\r\n};\r\n\r\nexport default memo(StripeShippingAddress);\r\n","import {\r\n    Address,\r\n    CheckoutParams,\r\n    CheckoutSelectors,\r\n    Consignment,\r\n    Country,\r\n    FormField,\r\n    RequestOptions,\r\n    ShippingInitializeOptions,\r\n    ShippingRequestOptions,\r\n} from '@bigcommerce/checkout-sdk';\r\nimport { FormikProps, withFormik } from 'formik';\r\nimport { noop } from 'lodash';\r\nimport React, { PureComponent, ReactNode } from 'react';\r\nimport { lazy, object } from 'yup';\r\n\r\nimport {\r\n    AddressFormValues,\r\n    getAddressFormFieldsValidationSchema,\r\n    getTranslateAddressError,\r\n    mapAddressToFormValues,\r\n} from '../../address';\r\nimport CheckoutStepStatus from '../../checkout/CheckoutStepStatus';\r\nimport { getCustomFormFieldsValidationSchema } from '../../formFields';\r\nimport { withLanguage, WithLanguageProps } from '../../locale';\r\nimport { Fieldset, Form, FormContext } from '../../ui/form';\r\nimport BillingSameAsShippingField from '../BillingSameAsShippingField';\r\nimport hasSelectedShippingOptions from '../hasSelectedShippingOptions';\r\nimport ShippingFormFooter from '../ShippingFormFooter';\r\n\r\nimport StripeShippingAddress from './StripeShippingAddress';\r\n\r\nexport interface SingleShippingFormProps {\r\n    isBillingSameAsShipping: boolean;\r\n    cartHasChanged: boolean;\r\n    consignments: Consignment[];\r\n    countries: Country[];\r\n    customerMessage: string;\r\n    isLoading: boolean;\r\n    isShippingMethodLoading: boolean;\r\n    isMultiShippingMode: boolean;\r\n    methodId?: string;\r\n    shippingAddress?: Address;\r\n    shouldShowOrderComments: boolean;\r\n    step: CheckoutStepStatus;\r\n    isStripeLoading?(): void;\r\n    isStripeAutoStep?(): void;\r\n    deinitialize(options: ShippingRequestOptions): Promise<CheckoutSelectors>;\r\n    getFields(countryCode?: string): FormField[];\r\n    initialize(options: ShippingInitializeOptions): Promise<CheckoutSelectors>;\r\n    onSubmit(values: SingleShippingFormValues): void;\r\n    onUnhandledError?(error: Error): void;\r\n    updateAddress(\r\n        address: Partial<Address>,\r\n        options?: RequestOptions<CheckoutParams>,\r\n    ): Promise<CheckoutSelectors>;\r\n}\r\n\r\nexport interface SingleShippingFormValues {\r\n    billingSameAsShipping: boolean;\r\n    shippingAddress?: AddressFormValues;\r\n    orderComment: string;\r\n}\r\n\r\ninterface SingleShippingFormState {\r\n    isUpdatingShippingData: boolean;\r\n}\r\n\r\nclass StripeShippingForm extends PureComponent<\r\n    SingleShippingFormProps & WithLanguageProps & FormikProps<SingleShippingFormValues>\r\n    > {\r\n    static contextType = FormContext;\r\n\r\n    state: SingleShippingFormState = {\r\n        isUpdatingShippingData: false,\r\n    };\r\n\r\n    render(): ReactNode {\r\n        const {\r\n            cartHasChanged,\r\n            isLoading,\r\n            countries,\r\n            isStripeLoading,\r\n            shippingAddress,\r\n            consignments,\r\n            shouldShowOrderComments,\r\n            initialize,\r\n            isValid,\r\n            deinitialize,\r\n            onSubmit,\r\n            isStripeAutoStep,\r\n            step,\r\n            isShippingMethodLoading,\r\n        } = this.props;\r\n\r\n        const { isUpdatingShippingData } = this.state;\r\n\r\n        return (\r\n            <Form autoComplete=\"on\">\r\n                <Fieldset>\r\n                    <StripeShippingAddress\r\n                        consignments={consignments}\r\n                        countries={countries}\r\n                        deinitialize={deinitialize}\r\n                        initialize={initialize}\r\n                        isShippingMethodLoading={isShippingMethodLoading}\r\n                        isStripeAutoStep={isStripeAutoStep}\r\n                        isStripeLoading={isStripeLoading}\r\n                        onAddressSelect={this.handleAddressSelect}\r\n                        onSubmit={onSubmit}\r\n                        shippingAddress={shippingAddress}\r\n                        shouldDisableSubmit={this.shouldDisableSubmit()}\r\n                        step={step}\r\n                    />\r\n                    <div className=\"form-body\">\r\n                        <BillingSameAsShippingField />\r\n                    </div>\r\n                </Fieldset>\r\n\r\n                <ShippingFormFooter\r\n                    cartHasChanged={cartHasChanged}\r\n                    isLoading={isLoading || isUpdatingShippingData}\r\n                    isMultiShippingMode={false}\r\n                    shouldDisableSubmit={this.shouldDisableSubmit()}\r\n                    shouldShowOrderComments={shouldShowOrderComments}\r\n                    shouldShowShippingOptions={isValid}\r\n                />\r\n            </Form>\r\n        );\r\n    }\r\n\r\n    private shouldDisableSubmit: () => boolean = () => {\r\n        const { isLoading, consignments, isValid } = this.props;\r\n\r\n        const { isUpdatingShippingData } = this.state;\r\n\r\n        if (!isValid) {\r\n            return false;\r\n        }\r\n\r\n        return isLoading || isUpdatingShippingData || !hasSelectedShippingOptions(consignments);\r\n    };\r\n\r\n    private handleAddressSelect: (address: Address) => void = async (address) => {\r\n        const { updateAddress, onUnhandledError = noop, values, setValues } = this.props;\r\n\r\n        try {\r\n            await updateAddress(address);\r\n\r\n            setValues({\r\n                ...values,\r\n                shippingAddress: mapAddressToFormValues(\r\n                    this.getFields(address.countryCode),\r\n                    address,\r\n                ),\r\n            });\r\n        } catch (error) {\r\n            onUnhandledError(error);\r\n        }\r\n    };\r\n\r\n    private getFields(countryCode: string | undefined): FormField[] {\r\n        const { getFields } = this.props;\r\n\r\n        return getFields(countryCode);\r\n    }\r\n}\r\n\r\nexport default withLanguage(\r\n    withFormik<SingleShippingFormProps & WithLanguageProps, SingleShippingFormValues>({\r\n        handleSubmit: (values, { props: { onSubmit } }) => {\r\n            onSubmit(values);\r\n        },\r\n        mapPropsToValues: ({\r\n                               getFields,\r\n                               shippingAddress,\r\n                               isBillingSameAsShipping,\r\n                               customerMessage,\r\n                           }) => ({\r\n            billingSameAsShipping: isBillingSameAsShipping,\r\n            orderComment: customerMessage,\r\n            shippingAddress: mapAddressToFormValues(\r\n                getFields(shippingAddress && shippingAddress.countryCode),\r\n                shippingAddress,\r\n            ),\r\n        }),\r\n        isInitialValid: ({ shippingAddress, getFields, language }) =>\r\n            !!shippingAddress &&\r\n            getAddressFormFieldsValidationSchema({\r\n                language,\r\n                formFields: getFields(shippingAddress.countryCode),\r\n            }).isValidSync(shippingAddress),\r\n        validationSchema: ({\r\n                               language,\r\n                               getFields,\r\n                               methodId,\r\n                           }: SingleShippingFormProps & WithLanguageProps) =>\r\n            methodId\r\n                ? object({\r\n                    shippingAddress: lazy<Partial<AddressFormValues>>((formValues) =>\r\n                        getCustomFormFieldsValidationSchema({\r\n                            translate: getTranslateAddressError(language),\r\n                            formFields: getFields(formValues && formValues.countryCode),\r\n                        }),\r\n                    ),\r\n                })\r\n                : object({\r\n                    shippingAddress: lazy<Partial<AddressFormValues>>((formValues) =>\r\n                        getAddressFormFieldsValidationSchema({\r\n                            language,\r\n                            formFields: getFields(formValues && formValues.countryCode),\r\n                        }),\r\n                    ),\r\n                }),\r\n        enableReinitialize: false,\r\n    })(StripeShippingForm),\r\n);\r\n","import { Address, CheckoutSelectors, Consignment, Country, Customer, FormField, ShippingInitializeOptions, ShippingRequestOptions } from '@bigcommerce/checkout-sdk';\r\nimport React, { Component, ReactNode } from 'react';\r\n\r\nimport CheckoutStepStatus from '../../checkout/CheckoutStepStatus';\r\nimport { LoadingOverlay } from '../../ui/loading';\r\nimport ShippingHeader from '../ShippingHeader';\r\n\r\nimport StripeShippingForm, { SingleShippingFormValues } from './StripeShippingForm';\r\n\r\nexport interface StripeShippingProps {\r\n    isBillingSameAsShipping: boolean;\r\n    cartHasChanged: boolean;\r\n    isMultiShippingMode: boolean;\r\n    step: CheckoutStepStatus;\r\n    consignments: Consignment[];\r\n    countries: Country[];\r\n    customer: Customer;\r\n    customerMessage: string;\r\n    isGuest: boolean;\r\n    isInitializing: boolean;\r\n    isLoading: boolean;\r\n    isShippingMethodLoading: boolean;\r\n    isShippingStepPending: boolean;\r\n    methodId?: string;\r\n    shippingAddress?: Address;\r\n    shouldShowAddAddressInCheckout: boolean;\r\n    shouldShowMultiShipping: boolean;\r\n    shouldShowOrderComments: boolean;\r\n    onReady?(): void;\r\n    onUnhandledError(error: Error): void;\r\n    onSubmit(values: SingleShippingFormValues): void;\r\n    onMultiShippingChange(): void;\r\n    deinitialize(options: ShippingRequestOptions): Promise<CheckoutSelectors>;\r\n    initialize(options: ShippingInitializeOptions): Promise<CheckoutSelectors>;\r\n    loadShippingAddressFields(): Promise<CheckoutSelectors>;\r\n    loadShippingOptions(): Promise<CheckoutSelectors>;\r\n    updateAddress(address: Partial<Address>): Promise<CheckoutSelectors>;\r\n    getFields(countryCode?: string): FormField[];\r\n}\r\n\r\ninterface StripeShippingState {\r\n    isStripeLoading: boolean;\r\n    isStripeAutoStep: boolean;\r\n}\r\n\r\nclass StripeShipping extends Component<StripeShippingProps, StripeShippingState> {\r\n    constructor(props: StripeShippingProps) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            isStripeLoading: true,\r\n            isStripeAutoStep: false,\r\n        };\r\n    }\r\n\r\n    render(): ReactNode {\r\n        const {\r\n            isBillingSameAsShipping,\r\n            isGuest,\r\n            shouldShowMultiShipping,\r\n            customer,\r\n            updateAddress,\r\n            initialize,\r\n            deinitialize,\r\n            isMultiShippingMode,\r\n            step,\r\n            onSubmit,\r\n            onMultiShippingChange,\r\n            isLoading,\r\n            isShippingMethodLoading,\r\n            ...shippingFormProps\r\n        } = this.props;\r\n\r\n        const {\r\n            isStripeLoading,\r\n            isStripeAutoStep,\r\n        } = this.state;\r\n\r\n            return <div className=\"checkout-form\">\r\n                <div style={ {display: isStripeAutoStep ? 'none' : undefined,} }>\r\n                    <LoadingOverlay\r\n                        hideContentWhenLoading\r\n                        isLoading={ isStripeLoading }\r\n                    >\r\n                        <ShippingHeader\r\n                            isGuest={ isGuest }\r\n                            isMultiShippingMode={ isMultiShippingMode }\r\n                            onMultiShippingChange={ onMultiShippingChange }\r\n                            shouldShowMultiShipping={ shouldShowMultiShipping }\r\n                        />\r\n\r\n                        <LoadingOverlay\r\n                            isLoading={ isLoading }\r\n                            unmountContentWhenLoading\r\n                        >\r\n                            <StripeShippingForm\r\n                                { ...shippingFormProps }\r\n                                deinitialize={deinitialize}\r\n                                initialize={initialize}\r\n                                isBillingSameAsShipping={isBillingSameAsShipping}\r\n                                isLoading={ isLoading }\r\n                                isMultiShippingMode={isMultiShippingMode}\r\n                                isShippingMethodLoading={isShippingMethodLoading}\r\n                                isStripeAutoStep={this.handleIsAutoStep}\r\n                                isStripeLoading={this.stripeLoadedCallback}\r\n                                onSubmit={onSubmit}\r\n                                step={step}\r\n                                updateAddress={updateAddress}\r\n                            />\r\n                        </LoadingOverlay>\r\n                    </LoadingOverlay>\r\n                </div>\r\n            </div>\r\n    }\r\n\r\n    private stripeLoadedCallback: () => void = () => {\r\n        this.setState({ isStripeLoading: false });\r\n    }\r\n\r\n    private handleIsAutoStep: () => void = () => {\r\n        this.setState({ isStripeAutoStep: true });\r\n    }\r\n}\r\n\r\nexport default StripeShipping;\r\n","import {\r\n    Address,\r\n    AddressRequestBody,\r\n    Cart,\r\n    CheckoutRequestBody,\r\n    CheckoutSelectors,\r\n    Consignment,\r\n    ConsignmentAssignmentRequestBody,\r\n    Country,\r\n    Customer,\r\n    CustomerRequestOptions,\r\n    FormField,\r\n    ShippingInitializeOptions,\r\n    ShippingRequestOptions,\r\n} from '@bigcommerce/checkout-sdk';\r\nimport { noop } from 'lodash';\r\nimport React, { Component, ReactNode } from 'react';\r\nimport { createSelector } from 'reselect';\r\n\r\nimport { AddressFormSkeleton } from '@bigcommerce/checkout/ui';\r\n\r\nimport { isEqualAddress, mapAddressFromFormValues } from '../address';\r\nimport { CheckoutContextProps, withCheckout } from '../checkout';\r\nimport CheckoutStepStatus from '../checkout/CheckoutStepStatus';\r\nimport { EMPTY_ARRAY, isFloatingLabelEnabled } from '../common/utility';\r\nimport { PaymentMethodId } from '../payment/paymentMethod';\r\n\r\nimport { UnassignItemError } from './errors';\r\nimport getShippableItemsCount from './getShippableItemsCount';\r\nimport getShippingMethodId from './getShippingMethodId';\r\nimport { MultiShippingFormValues } from './MultiShippingForm';\r\nimport ShippingForm from './ShippingForm';\r\nimport ShippingHeader from './ShippingHeader';\r\nimport { SingleShippingFormValues } from './SingleShippingForm';\r\nimport StripeShipping from './stripeUPE/StripeShipping';\r\n\r\nexport interface ShippingProps {\r\n    isBillingSameAsShipping: boolean;\r\n    cartHasChanged: boolean;\r\n    isMultiShippingMode: boolean;\r\n    step: CheckoutStepStatus;\r\n    onCreateAccount(): void;\r\n    onToggleMultiShipping(): void;\r\n    onReady?(): void;\r\n    onUnhandledError(error: Error): void;\r\n    onSignIn(): void;\r\n    navigateNextStep(isBillingSameAsShipping: boolean): void;\r\n}\r\n\r\nexport interface WithCheckoutShippingProps {\r\n    billingAddress?: Address;\r\n    cart: Cart;\r\n    consignments: Consignment[];\r\n    countries: Country[];\r\n    countriesWithAutocomplete: string[];\r\n    customer: Customer;\r\n    customerMessage: string;\r\n    googleMapsApiKey: string;\r\n    isGuest: boolean;\r\n    isInitializing: boolean;\r\n    isLoading: boolean;\r\n    isShippingStepPending: boolean;\r\n    methodId?: string;\r\n    shippingAddress?: Address;\r\n    shouldShowAddAddressInCheckout: boolean;\r\n    shouldShowMultiShipping: boolean;\r\n    shouldShowOrderComments: boolean;\r\n    isStripeLinkEnabled?: boolean;\r\n    useFloatingLabel?: boolean;\r\n    assignItem(consignment: ConsignmentAssignmentRequestBody): Promise<CheckoutSelectors>;\r\n    deinitializeShippingMethod(options: ShippingRequestOptions): Promise<CheckoutSelectors>;\r\n    deleteConsignments(): Promise<Address | undefined>;\r\n    getFields(countryCode?: string): FormField[];\r\n    initializeShippingMethod(options: ShippingInitializeOptions): Promise<CheckoutSelectors>;\r\n    loadShippingAddressFields(): Promise<CheckoutSelectors>;\r\n    loadShippingOptions(): Promise<CheckoutSelectors>;\r\n    signOut(options?: CustomerRequestOptions): void;\r\n    createCustomerAddress(address: AddressRequestBody): Promise<CheckoutSelectors>;\r\n    unassignItem(consignment: ConsignmentAssignmentRequestBody): Promise<CheckoutSelectors>;\r\n    updateBillingAddress(address: Partial<Address>): Promise<CheckoutSelectors>;\r\n    updateCheckout(payload: CheckoutRequestBody): Promise<CheckoutSelectors>;\r\n    updateShippingAddress(address: Partial<Address>): Promise<CheckoutSelectors>;\r\n    loadPaymentMethods(): Promise<CheckoutSelectors>;\r\n}\r\n\r\ninterface ShippingState {\r\n    isInitializing: boolean;\r\n}\r\n\r\nclass Shipping extends Component<ShippingProps & WithCheckoutShippingProps, ShippingState> {\r\n    constructor(props: ShippingProps & WithCheckoutShippingProps) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            isInitializing: true,\r\n        };\r\n    }\r\n\r\n    async componentDidMount(): Promise<void> {\r\n        const {\r\n            loadShippingAddressFields,\r\n            loadShippingOptions,\r\n            loadPaymentMethods,\r\n            onReady = noop,\r\n            onUnhandledError = noop,\r\n        } = this.props;\r\n\r\n        try {\r\n            await Promise.all([loadShippingAddressFields(), loadShippingOptions()]);\r\n\r\n            onReady();\r\n            await loadPaymentMethods();\r\n        } catch (error) {\r\n            onUnhandledError(error);\r\n        } finally {\r\n            this.setState({ isInitializing: false });\r\n        }\r\n    }\r\n\r\n    render(): ReactNode {\r\n        const {\r\n            isBillingSameAsShipping,\r\n            isGuest,\r\n            shouldShowMultiShipping,\r\n            customer,\r\n            unassignItem,\r\n            updateShippingAddress,\r\n            initializeShippingMethod,\r\n            deinitializeShippingMethod,\r\n            isMultiShippingMode,\r\n            onToggleMultiShipping,\r\n            isStripeLinkEnabled,\r\n            step,\r\n            useFloatingLabel,\r\n            ...shippingFormProps\r\n        } = this.props;\r\n\r\n        const {\r\n            isInitializing,\r\n        } = this.state;\r\n\r\n        if (isStripeLinkEnabled && !customer.email && this.props.countries.length > 0) {\r\n            return <StripeShipping\r\n                { ...shippingFormProps }\r\n                customer={ customer }\r\n                deinitialize={deinitializeShippingMethod}\r\n                initialize={initializeShippingMethod}\r\n                isBillingSameAsShipping={isBillingSameAsShipping}\r\n                isGuest={ isGuest }\r\n                isLoading={ isInitializing }\r\n                isMultiShippingMode={isMultiShippingMode}\r\n                isShippingMethodLoading={ this.props.isLoading }\r\n                onMultiShippingChange={ this.handleMultiShippingModeSwitch }\r\n                onSubmit={this.handleSingleShippingSubmit}\r\n                shouldShowMultiShipping={ shouldShowMultiShipping }\r\n                step={step}\r\n                updateAddress={updateShippingAddress}\r\n            />;\r\n        }\r\n\r\n        return (\r\n            <AddressFormSkeleton isLoading={isInitializing}>\r\n                <div className=\"checkout-form\">\r\n                    <ShippingHeader\r\n                        isGuest={isGuest}\r\n                        isMultiShippingMode={isMultiShippingMode}\r\n                        onMultiShippingChange={this.handleMultiShippingModeSwitch}\r\n                        shouldShowMultiShipping={shouldShowMultiShipping}\r\n                    />\r\n                    <ShippingForm\r\n                        {...shippingFormProps}\r\n                        addresses={customer.addresses}\r\n                        deinitialize={deinitializeShippingMethod}\r\n                        initialize={initializeShippingMethod}\r\n                        isBillingSameAsShipping={isBillingSameAsShipping}\r\n                        isGuest={isGuest}\r\n                        isMultiShippingMode={isMultiShippingMode}\r\n                        onMultiShippingSubmit={this.handleMultiShippingSubmit}\r\n                        onSingleShippingSubmit={this.handleSingleShippingSubmit}\r\n                        onUseNewAddress={this.handleUseNewAddress}\r\n                        shouldShowSaveAddress={!isGuest}\r\n                        updateAddress={updateShippingAddress}\r\n                        useFloatingLabel={useFloatingLabel}\r\n                    />\r\n                </div>\r\n            </AddressFormSkeleton>\r\n        );\r\n    }\r\n\r\n    private handleMultiShippingModeSwitch: () => void = async () => {\r\n        const {\r\n            consignments,\r\n            isMultiShippingMode,\r\n            onToggleMultiShipping = noop,\r\n            onUnhandledError = noop,\r\n            updateShippingAddress,\r\n        } = this.props;\r\n\r\n        if (isMultiShippingMode && consignments.length > 1) {\r\n            this.setState({ isInitializing: true });\r\n\r\n            try {\r\n                // Collapse all consignments into one\r\n                await updateShippingAddress(consignments[0].shippingAddress);\r\n            } catch (error) {\r\n                onUnhandledError(error);\r\n            } finally {\r\n                this.setState({ isInitializing: false });\r\n            }\r\n        }\r\n\r\n        onToggleMultiShipping();\r\n    };\r\n\r\n    private handleSingleShippingSubmit: (values: SingleShippingFormValues) => void = async ({\r\n        billingSameAsShipping,\r\n        shippingAddress: addressValues,\r\n        orderComment,\r\n    }) => {\r\n        const {\r\n            customerMessage,\r\n            updateCheckout,\r\n            updateShippingAddress,\r\n            updateBillingAddress,\r\n            navigateNextStep,\r\n            onUnhandledError,\r\n            shippingAddress,\r\n            billingAddress,\r\n            methodId,\r\n        } = this.props;\r\n\r\n        const updatedShippingAddress = addressValues && mapAddressFromFormValues(addressValues);\r\n        const promises: Array<Promise<CheckoutSelectors>> = [];\r\n        const hasRemoteBilling = this.hasRemoteBilling(methodId);\r\n\r\n        if (!isEqualAddress(updatedShippingAddress, shippingAddress) || shippingAddress?.shouldSaveAddress !== updatedShippingAddress?.shouldSaveAddress) {\r\n            promises.push(updateShippingAddress(updatedShippingAddress || {}));\r\n        }\r\n\r\n        if (\r\n            billingSameAsShipping &&\r\n            updatedShippingAddress &&\r\n            !isEqualAddress(updatedShippingAddress, billingAddress) &&\r\n            !hasRemoteBilling\r\n        ) {\r\n            promises.push(updateBillingAddress(updatedShippingAddress));\r\n        }\r\n\r\n        if (customerMessage !== orderComment) {\r\n            promises.push(updateCheckout({ customerMessage: orderComment }));\r\n        }\r\n\r\n        try {\r\n            await Promise.all(promises);\r\n\r\n            navigateNextStep(billingSameAsShipping);\r\n        } catch (error) {\r\n            if (error instanceof Error) {\r\n                onUnhandledError(error);\r\n            }\r\n        }\r\n    };\r\n\r\n    private hasRemoteBilling: (methodId?: string) => boolean = (methodId) => {\r\n        const PAYMENT_METHOD_VALID = ['amazonpay'];\r\n\r\n        return PAYMENT_METHOD_VALID.some((method) => method === methodId);\r\n    };\r\n\r\n    private handleUseNewAddress: (address: Address, itemId: string) => void = async (\r\n        address,\r\n        itemId,\r\n    ) => {\r\n        const { unassignItem, onUnhandledError } = this.props;\r\n\r\n        try {\r\n            await unassignItem({\r\n                address,\r\n                lineItems: [\r\n                    {\r\n                        quantity: 1,\r\n                        itemId,\r\n                    },\r\n                ],\r\n            });\r\n\r\n            location.href = '/account.php?action=add_shipping_address&from=checkout';\r\n        } catch (error) {\r\n            if (error instanceof UnassignItemError) {\r\n                onUnhandledError(new UnassignItemError(error));\r\n            }\r\n        }\r\n    };\r\n\r\n    private handleMultiShippingSubmit: (values: MultiShippingFormValues) => void = async ({\r\n        orderComment,\r\n    }) => {\r\n        const { customerMessage, updateCheckout, navigateNextStep, onUnhandledError } = this.props;\r\n\r\n        try {\r\n            if (customerMessage !== orderComment) {\r\n                await updateCheckout({ customerMessage: orderComment });\r\n            }\r\n\r\n            navigateNextStep(false);\r\n        } catch (error) {\r\n            if (error instanceof Error) {\r\n                onUnhandledError(error);\r\n            }\r\n        }\r\n    };\r\n}\r\n\r\nconst deleteConsignmentsSelector = createSelector(\r\n    ({ checkoutService: { deleteConsignment } }: CheckoutContextProps) => deleteConsignment,\r\n    ({ checkoutState: { data } }: CheckoutContextProps) => data.getConsignments(),\r\n    (deleteConsignment, consignments) => async () => {\r\n        if (!consignments || !consignments.length) {\r\n            return;\r\n        }\r\n\r\n        const [{ data }] = await Promise.all(consignments.map(({ id }) => deleteConsignment(id)));\r\n\r\n        return data.getShippingAddress();\r\n    },\r\n);\r\n\r\n// tslint:disable-next-line:cyclomatic-complexity\r\nexport function mapToShippingProps({\r\n    checkoutService,\r\n    checkoutState,\r\n}: CheckoutContextProps): WithCheckoutShippingProps | null {\r\n    const {\r\n        data: {\r\n            getCart,\r\n            getCheckout,\r\n            getConfig,\r\n            getCustomer,\r\n            getConsignments,\r\n            getShippingAddress,\r\n            getBillingAddress,\r\n            getShippingAddressFields,\r\n            getShippingCountries,\r\n            getPaymentMethod,\r\n        },\r\n        statuses: {\r\n            isShippingStepPending,\r\n            isSelectingShippingOption,\r\n            isLoadingShippingOptions,\r\n            isUpdatingConsignment,\r\n            isCreatingConsignments,\r\n            isCreatingCustomerAddress,\r\n            isLoadingShippingCountries,\r\n            isUpdatingBillingAddress,\r\n            isUpdatingCheckout,\r\n        },\r\n    } = checkoutState;\r\n\r\n    const checkout = getCheckout();\r\n    const config = getConfig();\r\n    const consignments = getConsignments() || [];\r\n    const customer = getCustomer();\r\n    const cart = getCart();\r\n\r\n    if (!checkout || !config || !customer || !cart) {\r\n        return null;\r\n    }\r\n\r\n    const {\r\n        checkoutSettings: {\r\n            enableOrderComments,\r\n            features,\r\n            hasMultiShippingEnabled,\r\n            googleMapsApiKey,\r\n        },\r\n    } = config;\r\n\r\n    const methodId = getShippingMethodId(checkout);\r\n    const shippableItemsCount = getShippableItemsCount(cart);\r\n    const isLoading =\r\n        isLoadingShippingOptions() ||\r\n        isSelectingShippingOption() ||\r\n        isUpdatingConsignment() ||\r\n        isCreatingConsignments() ||\r\n        isUpdatingBillingAddress() ||\r\n        isUpdatingCheckout() ||\r\n        isCreatingCustomerAddress();\r\n    const shouldShowMultiShipping =\r\n        hasMultiShippingEnabled && !methodId && shippableItemsCount > 1 && shippableItemsCount < 50;\r\n    const countriesWithAutocomplete = ['US', 'CA', 'AU', 'NZ'];\r\n    const stripeUpe = getPaymentMethod('card', PaymentMethodId.StripeUPE);\r\n    const linkEnabled = stripeUpe?.initializationData.enableLink || false;\r\n    const stripeUpeSupportedCurrency = cart?.currency.code === 'USD' || false;\r\n    const stripeUpeLinkEnabled = linkEnabled && stripeUpeSupportedCurrency;\r\n\r\n    if (features['CHECKOUT-4183.checkout_google_address_autocomplete_uk']) {\r\n        countriesWithAutocomplete.push('GB');\r\n    }\r\n\r\n    const shippingAddress =\r\n        !shouldShowMultiShipping && consignments.length > 1 ? undefined : getShippingAddress();\r\n\r\n    return {\r\n        assignItem: checkoutService.assignItemsToAddress,\r\n        billingAddress: getBillingAddress(),\r\n        cart,\r\n        consignments,\r\n        countries: getShippingCountries() || EMPTY_ARRAY,\r\n        countriesWithAutocomplete,\r\n        customer,\r\n        customerMessage: checkout.customerMessage,\r\n        createCustomerAddress: checkoutService.createCustomerAddress,\r\n        deinitializeShippingMethod: checkoutService.deinitializeShipping,\r\n        deleteConsignments: deleteConsignmentsSelector({ checkoutService, checkoutState }),\r\n        getFields: getShippingAddressFields,\r\n        googleMapsApiKey,\r\n        initializeShippingMethod: checkoutService.initializeShipping,\r\n        isGuest: customer.isGuest,\r\n        isInitializing: isLoadingShippingCountries() || isLoadingShippingOptions(),\r\n        isLoading,\r\n        isShippingStepPending: isShippingStepPending(),\r\n        loadShippingAddressFields: checkoutService.loadShippingAddressFields,\r\n        loadShippingOptions: checkoutService.loadShippingOptions,\r\n        methodId,\r\n        shippingAddress,\r\n        shouldShowMultiShipping,\r\n        shouldShowAddAddressInCheckout:\r\n            features['CHECKOUT-4726.add_address_in_multishipping_checkout'],\r\n        shouldShowOrderComments: enableOrderComments,\r\n        signOut: checkoutService.signOutCustomer,\r\n        unassignItem: checkoutService.unassignItemsToAddress,\r\n        updateBillingAddress: checkoutService.updateBillingAddress,\r\n        updateCheckout: checkoutService.updateCheckout,\r\n        updateShippingAddress: checkoutService.updateShippingAddress,\r\n        isStripeLinkEnabled: stripeUpeLinkEnabled,\r\n        loadPaymentMethods: checkoutService.loadPaymentMethods,\r\n        useFloatingLabel: isFloatingLabelEnabled(config.checkoutSettings),\r\n    };\r\n}\r\n\r\nexport default withCheckout(mapToShippingProps)(Shipping);\r\n","import { noop } from 'lodash';\r\nimport { createContext } from 'react';\r\n\r\nexport interface AccordionContextProps {\r\n    selectedItemId?: string;\r\n    onToggle(id: string): void;\r\n}\r\n\r\nconst AccordionContext = createContext<AccordionContextProps>({ onToggle: noop });\r\n\r\nexport default AccordionContext;\r\n","import { memoizeOne } from '@bigcommerce/memoize';\r\nimport { noop } from 'lodash';\r\nimport React, { Component, ReactNode } from 'react';\r\n\r\nimport AccordionContext from './AccordionContext';\r\n\r\nexport interface AccordionProps {\r\n    children: ReactNode;\r\n    className?: string;\r\n    defaultSelectedItemId?: string;\r\n    isDisabled?: boolean;\r\n    onSelect?(id: string): void;\r\n}\r\n\r\nexport interface AccordionState {\r\n    selectedItemId?: string;\r\n}\r\n\r\nexport default class Accordion extends Component<AccordionProps, AccordionState> {\r\n    state: AccordionState = {};\r\n\r\n    private getContextValue = memoizeOne((selectedItemId) => {\r\n        return {\r\n            onToggle: this.handleToggleItem,\r\n            selectedItemId,\r\n        };\r\n    });\r\n\r\n    render(): ReactNode {\r\n        const { children, className = 'accordion', defaultSelectedItemId } = this.props;\r\n\r\n        const { selectedItemId = defaultSelectedItemId } = this.state;\r\n\r\n        return (\r\n            <AccordionContext.Provider value={this.getContextValue(selectedItemId)}>\r\n                <ul className={className}>{children}</ul>\r\n            </AccordionContext.Provider>\r\n        );\r\n    }\r\n\r\n    private handleToggleItem: (id: string) => void = (id) => {\r\n        const { isDisabled, onSelect = noop } = this.props;\r\n\r\n        if (isDisabled) {\r\n            return;\r\n        }\r\n\r\n        this.setState({ selectedItemId: id });\r\n        onSelect(id);\r\n    };\r\n}\r\n","import { noop } from 'lodash';\r\nimport React, {\r\n    createContext,\r\n    FunctionComponent,\r\n    memo,\r\n    ReactNode,\r\n    useCallback,\r\n    useMemo,\r\n} from 'react';\r\n\r\nimport { connectFormik, ConnectFormikProps } from '../../common/form';\r\nimport { Accordion } from '../accordion';\r\n\r\nexport interface ChecklistProps {\r\n    children: ReactNode;\r\n    defaultSelectedItemId?: string;\r\n    isDisabled?: boolean;\r\n    name: string;\r\n    onSelect?(value: string): void;\r\n}\r\n\r\nexport interface ChecklistContextProps {\r\n    name: string;\r\n}\r\n\r\nexport const ChecklistContext = createContext<ChecklistContextProps | undefined>(undefined);\r\n\r\nconst Checklist: FunctionComponent<\r\n    ChecklistProps & ConnectFormikProps<{ [key: string]: string }>\r\n> = ({ formik: { setFieldValue }, name, onSelect = noop, ...props }) => {\r\n    const handleSelect = useCallback(\r\n        (value: string) => {\r\n            setFieldValue(name, value);\r\n            onSelect(value);\r\n        },\r\n        [name, onSelect, setFieldValue],\r\n    );\r\n\r\n    const contextValue = useMemo(() => ({ name }), [name]);\r\n\r\n    return (\r\n        <ChecklistContext.Provider value={contextValue}>\r\n            <Accordion\r\n                {...props}\r\n                className=\"form-checklist optimizedCheckout-form-checklist\"\r\n                onSelect={handleSelect}\r\n            />\r\n        </ChecklistContext.Provider>\r\n    );\r\n};\r\n\r\nexport default connectFormik(memo(Checklist));\r\n","import classNames from 'classnames';\r\nimport React, { FunctionComponent, memo, ReactNode, useCallback, useContext } from 'react';\r\nimport { CSSTransition } from 'react-transition-group';\r\n\r\nimport AccordionContext from './AccordionContext';\r\n\r\nexport interface AccordionItemProps {\r\n    bodyClassName?: string;\r\n    children?: ReactNode;\r\n    className?: string;\r\n    classNameSelected?: string;\r\n    headerClassName?: string;\r\n    headerClassNameSelected?: string;\r\n    itemId: string;\r\n    headerContent(props: AccordionItemHeaderProps): ReactNode;\r\n}\r\n\r\nexport interface AccordionItemHeaderProps {\r\n    isSelected: boolean;\r\n    onToggle(id: string): void;\r\n}\r\n\r\nconst AccordionItem: FunctionComponent<AccordionItemProps> = ({\r\n    bodyClassName = 'accordion-item-body',\r\n    children,\r\n    className = 'accordion-item',\r\n    classNameSelected = 'accordion-item--selected',\r\n    headerClassName = 'accordion-item-header',\r\n    headerClassNameSelected = 'accordion-item-header--selected',\r\n    headerContent,\r\n    itemId,\r\n}) => {\r\n    const { onToggle, selectedItemId } = useContext(AccordionContext);\r\n    const isSelected = selectedItemId === itemId;\r\n\r\n    const transitionEndListener = useCallback((node, done) => {\r\n        node.addEventListener('transitionend', ({ target }: Event) => {\r\n            if (target === node) {\r\n                done();\r\n            }\r\n        });\r\n    }, []);\r\n\r\n    return (\r\n        <li\r\n            className={classNames(className, { [classNameSelected]: isSelected })}\r\n        >\r\n            <div className={classNames(headerClassName, { [headerClassNameSelected]: isSelected })}>\r\n                {headerContent({ isSelected, onToggle })}\r\n            </div>\r\n\r\n            {children && (\r\n                <CSSTransition\r\n                    addEndListener={transitionEndListener}\r\n                    classNames={bodyClassName}\r\n                    in={isSelected}\r\n                    mountOnEnter\r\n                    timeout={{}}\r\n                    unmountOnExit\r\n                >\r\n                    <div className={bodyClassName}>{children}</div>\r\n                </CSSTransition>\r\n            )}\r\n        </li>\r\n    );\r\n};\r\n\r\nexport default memo(AccordionItem);\r\n","import React, { FunctionComponent, InputHTMLAttributes } from 'react';\r\n\r\nimport Input from './Input';\r\nimport Label from './Label';\r\n\r\nexport interface ChecklistItemInputProps extends InputHTMLAttributes<HTMLInputElement> {\r\n    isSelected: boolean;\r\n}\r\n\r\nconst ChecklistItemInput: FunctionComponent<ChecklistItemInputProps> = ({\r\n    id,\r\n    isSelected,\r\n    children,\r\n    ...props\r\n}) => (\r\n    <>\r\n        <Input\r\n            {...props}\r\n            checked={isSelected}\r\n            className=\"form-checklist-checkbox optimizedCheckout-form-checklist-checkbox\"\r\n            id={id}\r\n            type=\"radio\"\r\n        />\r\n\r\n        <Label htmlFor={id}>{children}</Label>\r\n    </>\r\n);\r\n\r\nexport default ChecklistItemInput;\r\n","import { memoizeOne } from '@bigcommerce/memoize';\r\nimport { FieldProps } from 'formik';\r\nimport { kebabCase } from 'lodash';\r\nimport React, { FunctionComponent, memo, ReactNode, useCallback, useContext } from 'react';\r\n\r\nimport { AccordionItem, AccordionItemHeaderProps } from '../accordion';\r\n\r\nimport BasicFormField from './BasicFormField';\r\nimport { ChecklistContext } from './Checklist';\r\nimport ChecklistItemInput from './ChecklistItemInput';\r\n\r\nexport interface ChecklistItemProps {\r\n    content?: ReactNode;\r\n    htmlId?: string;\r\n    isDisabled?: boolean;\r\n    label: ReactNode | ((isSelected: boolean) => ReactNode);\r\n    value: string;\r\n}\r\n\r\nconst ChecklistItem: FunctionComponent<ChecklistItemProps> = ({\r\n    isDisabled,\r\n    value,\r\n    content,\r\n    htmlId = kebabCase(value),\r\n    label,\r\n    ...rest\r\n}) => {\r\n    const { name = '' } = useContext(ChecklistContext) || {};\r\n\r\n    const renderInput = useCallback(\r\n        memoizeOne((isSelected: boolean) => ({ field }: FieldProps) => (\r\n            <ChecklistItemInput\r\n                {...field}\r\n                disabled={isDisabled}\r\n                id={htmlId}\r\n                isSelected={field.value === value}\r\n                value={value}\r\n            >\r\n                {label instanceof Function ? label(isSelected) : label}\r\n            </ChecklistItemInput>\r\n        )),\r\n        [htmlId, isDisabled, label, value],\r\n    );\r\n\r\n    const handleChange = useCallback(\r\n        memoizeOne((onToggle: (id: string) => void) => (selectedValue: string) => {\r\n            if (value === selectedValue) {\r\n                onToggle(value);\r\n            }\r\n        }),\r\n        [],\r\n    );\r\n\r\n    const renderHeaderContent = useCallback(\r\n        ({ isSelected, onToggle }: AccordionItemHeaderProps) => (\r\n            <BasicFormField\r\n                className=\"form-checklist-option\"\r\n                name={name}\r\n                onChange={handleChange(onToggle)}\r\n                render={renderInput(isSelected)}\r\n            />\r\n        ),\r\n        [handleChange, name, renderInput],\r\n    );\r\n\r\n    return (\r\n        <AccordionItem\r\n            {...rest}\r\n            bodyClassName=\"form-checklist-body\"\r\n            className=\"form-checklist-item optimizedCheckout-form-checklist-item\"\r\n            classNameSelected=\"form-checklist-item--selected optimizedCheckout-form-checklist-item--selected\"\r\n            headerClassName=\"form-checklist-header\"\r\n            headerClassNameSelected=\"form-checklist-header--selected\"\r\n            headerContent={renderHeaderContent}\r\n            itemId={value}\r\n        >\r\n            {content}\r\n        </AccordionItem>\r\n    );\r\n};\r\n\r\nexport default memo(ChecklistItem);\r\n"],"names":["getAppliedStyles","element","properties","declaration","window","getComputedStyle","reduce","result","propertyName","getPropertyValue","kebabCase","connectFormik","OriginalComponent","InnerComponent","memo","props","prevFormik","prevProps","nextFormik","nextProps","DecoratedComponent","connect","displayName","name","parseAnchor","text","div","document","createElement","innerHTML","anchor","querySelector","anchorSiblings","split","outerHTML","data","id","language","onClick","testId","translatedString","translate","parsedString","length","href","message","getLanguageService","UnassignItemError","prototype","CustomError","getShippingMethodId","checkout","preselectedPayment","getPreselectedPayment","indexOf","providerId","undefined","SaveAddressForm","withLanguage","withFormik","handleSubmit","values","onSaveAddress","mapPropsToValues","defaultCountryCode","firstName","lastName","address1","address2","customFields","country","countryCode","stateOrProvince","stateOrProvinceCode","postalCode","phone","city","company","shouldSaveAddress","validationSchema","getFields","getAddressFormFieldsValidationSchema","formFields","googleMapsApiKey","countriesWithAutocomplete","countries","setFieldValue","isLoading","onRequestClose","useFloatingLabel","Form","autoComplete","LoadingOverlay","AddressForm","shouldShowSaveAddress","className","preventDefault","TranslatedString","Button","disabled","type","variant","isOpen","onAfterOpen","addressFormProps","Modal","additionalModalClassName","header","ModalHeader","shouldShowCloseButton","title","AssignItemInvalidAddressError","AssignItemFailedError","findConsignment","consignments","itemId","find","consignment","includes","lineItemIds","getShippableLineItems","cart","lineItems","physicalItems","item","i","addedByPromotion","isNil","parentId","concat","lineItemIndex","splitItems","quantity","key","variantId","productId","splitItem","imageUrl","options","addresses","onSelectAddress","onUseNewAddress","handleUseNewAddress","useCallback","address","handleSelectAddress","alt","src","map","optionName","value","nameId","AddressSelect","selectedAddress","shippingAddress","getRecommendedShippingOption","availableShippingOptions","ShippingOptionListItem","consignmentId","shippingOption","renderLabel","StaticShippingOption","displayAdditionalInformation","method","ChecklistItem","htmlId","label","inputName","shippingOptions","selectedShippingOptionId","onSelectedOption","handleSelect","Checklist","defaultSelectedItemId","onSelect","selectDefaultShippingOptions","this","selectShippingOption","getConsignments","selectedShippingOption","recommendedOption","singleShippingOption","defaultShippingOption","componentDidMount","subscribeToConsignments","unsubscribe","componentDidUpdate","analyticsTracker","shouldShowShippingOptions","showShippingMethods","componentWillUnmount","render","isMultiShippingMode","invalidShippingMessage","methodId","renderConsignment","ChecklistSkeleton","additionalClassName","rows","renderNoShippingOptions","role","StaticAddress","StaticConsignmentItemList","PureComponent","withAnalytics","noop","shippingOptionIds","forEach","ShippingOptionsForm","subscribeToConsignmentsSelector","createSelector","subscribe","subscriber","isLoadingSelector","_","isLoadingShippingOptions","isSelectingShippingOption","isUpdatingConsignment","isCreatingConsignments","isUpdatingAddress","withCheckout","checkoutService","checkoutState","getCart","getConfig","getCustomer","getCheckout","customer","config","unsortedConsignments","shippableItems","consignmentsOrder","uniq","sortBy","sortConsignments","shippingQuoteFailedMessage","checkoutSettings","expressShipping","option","description","standardShipping","Math","ceil","cost","coupons","count","existingCoupon","coupon","code","discountedAmount","toFixed","removeCoupon","fetch","mode","body","JSON","stringify","cartId","shippingRateDelta","then","res","json","applyCoupon","selectConsignmentShippingOption","cartHasChanged","shouldShowOrderComments","shouldDisableSubmit","Fieldset","legend","Legend","Alert","ShippingOptions","OrderComments","updateShippableItems","items","updatedItemIndex","cartItemIds","updatedConsignment","isEqualAddress","newId","matchingCartItems","filter","matchingCartItemIds","findNewItemId","state","handleCloseErrorModal","setState","createCustomerAddressError","handleSaveAddress","createCustomerAddress","itemAddingAddress","mapAddressFromFormValues","Error","itemKey","handleCloseAddAddressForm","assignItem","onUnhandledError","isValidAddress","syncItems","hasSelectedShippingOptions","currentItems","findIndex","getDerivedStateFromProps","getShippableItemsCount","isGuest","onSignIn","onCreateAccount","TranslatedLink","ErrorModal","error","onClose","shouldShowErrorCode","hasUnassignedLineItems","onSubmit","orderComment","enableReinitialize","MultiShippingForm","onChange","labelContent","useMemo","CheckboxFormField","handleFieldValueChange","onFieldChange","initialize","deinitialize","containerId","tabIndex","field","DynamicFormField","parentFieldName","addressFieldName","fieldName","fieldValue","formFieldName","custom","handleChange","handleAutocompleteToggle","inputValue","onAddressSelect","formAddress","disabledFields","hasAddresses","hasValidCustomerAddress","isValidCustomerAddress","unmountContentWhenLoading","onAutocompleteToggle","Component","ShippingAddressForm","buttonId","customFormFields","shouldShowCustomFormFields","style","padding","size","hasRequestedShippingOptions","isShippingStepPending","setSubmitted","useContext","initializeShipping","memoizeOne","defaultOptions","amazon","container","onError","editAddressButtonId","amazonpay","SHIPPING_ADDRESS_FIELDS","isResettingAddress","isUpdatingShippingData","isValid","handleFieldChange","Promise","resolve","setTimeout","isShippingField","updateAddressWithFormData","handleAddressSelect","updateAddress","setValues","mapAddressToFormValues","deleteConsignments","debouncedUpdateAddress","debounce","includeShippingOptions","params","include","location","search","urlParams","URLSearchParams","get","billingSameAsShipping","addressForm","shouldShowBillingSameAsShipping","some","updatedShippingAddress","contextType","isInitialValid","isValidSync","formValues","getCustomFormFieldsValidationSchema","SingleShippingForm","customerMessage","isBillingSameAsShipping","onMultiShippingSubmit","onSingleShippingSubmit","shouldShowAddAddressInCheckout","signOut","ShippingForm","onMultiShippingChange","shouldShowMultiShipping","width","StripeStateMapper","stateList","Object","keys","getStripeState","step","isStripeLoading","isStripeAutoStep","isShippingMethodLoading","useState","isNewAddress","setIsNewAddress","isFirstShippingRender","setIsFirstShippingRender","stripeShippingAddress","setStripeShippingAddress","handleLoading","useEffect","availableShippingList","allowedCountries","join","handleStripeShippingAddress","shipping","complete","line1","line2","postal_code","isComplete","names","shippingValue","current","getStylesFromElement","parentContainer","getElementById","getStripeStyles","formInput","formLabel","formError","labelText","color","fieldText","fieldPlaceholderText","fieldErrorText","fieldBackground","fieldInnerShadow","fieldBorder","stripeupe","onChangeShipping","availableCountries","getStyles","gatewayId","placeholder","StripeShippingForm","stripeLoadedCallback","handleIsAutoStep","shippingFormProps","display","hideContentWhenLoading","handleMultiShippingModeSwitch","onToggleMultiShipping","updateShippingAddress","isInitializing","handleSingleShippingSubmit","addressValues","updateCheckout","updateBillingAddress","navigateNextStep","billingAddress","promises","hasRemoteBilling","push","all","unassignItem","handleMultiShippingSubmit","loadShippingAddressFields","loadShippingOptions","loadPaymentMethods","onReady","initializeShippingMethod","deinitializeShippingMethod","isStripeLinkEnabled","email","AddressFormSkeleton","deleteConsignmentsSelector","deleteConsignment","getShippingAddress","mapToShippingProps","getBillingAddress","getShippingAddressFields","getShippingCountries","getPaymentMethod","isCreatingCustomerAddress","isLoadingShippingCountries","isUpdatingBillingAddress","isUpdatingCheckout","enableOrderComments","features","hasMultiShippingEnabled","shippableItemsCount","stripeUpe","PaymentMethodId","linkEnabled","initializationData","enableLink","stripeUpeSupportedCurrency","currency","stripeUpeLinkEnabled","assignItemsToAddress","deinitializeShipping","signOutCustomer","unassignItemsToAddress","isFloatingLabelEnabled","Shipping","createContext","onToggle","getContextValue","selectedItemId","handleToggleItem","isDisabled","children","AccordionContext","ChecklistContext","contextValue","Provider","bodyClassName","classNameSelected","headerClassName","headerClassNameSelected","headerContent","isSelected","transitionEndListener","node","done","addEventListener","CSSTransition","addEndListener","classNames","in","mountOnEnter","timeout","unmountOnExit","Input","checked","Label","htmlFor","content","rest","renderInput","Function","selectedValue","renderHeaderContent","BasicFormField"],"sourceRoot":""}